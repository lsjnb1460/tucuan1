/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/pjax-api@3.44.1/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*! pjax-api v3.44.1 https://github.com/falsandtru/pjax-api | (c) 2012, falsandtru | (Apache-2.0 AND MPL-2.0) License */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["pjax-api"]=t():e["pjax-api"]=t()}(this,(()=>(()=>{var e={8257:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(518);var o=r(2076);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(o).default}}),s(r(2076),t)},5413:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSetPrototypeOf=t.ObjectGetPrototypeOf=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.isArray=t.sqrt=t.log10=t.log2=t.log=t.tan=t.cos=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.PI=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.EPSILON=t.MIN_VALUE=t.MIN_SAFE_INTEGER=t.MAX_VALUE=t.MAX_SAFE_INTEGER=void 0,t.MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER,t.MAX_VALUE=Number.MAX_VALUE,t.MIN_SAFE_INTEGER=Number.MIN_SAFE_INTEGER,t.MIN_VALUE=Number.MIN_VALUE,t.EPSILON=Number.EPSILON,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.PI=Math.PI,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.cos=Math.cos,t.tan=Math.tan,t.log=Math.log,t.log2=Math.log2,t.log10=Math.log10,t.sqrt=Math.sqrt,t.isArray=Array.isArray,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectSetPrototypeOf=Object.setPrototypeOf},6876:(e,t)=>{"use strict";function r(e,t){if("length"in e){if(1===e.length)return t.unshift(e[0]),t;if(Array.isArray(e))return t.unshift(...e),t;for(let r=e.length;r--;)t.unshift(e[r])}else t.unshift(...e);return t}function n(e,t){if("length"in t){if(1===t.length)return e.push(t[0]),e;if(Array.isArray(t)&&t.length>100)return e.push(...t),e;for(let r=t.length,n=0;n<r;++n)e.push(t[n])}else for(const r of t)e.push(r);return e}function s(e,t,s,...i){if(0===e.length)return n(e,i),[];if(t>e.length?t=e.length:t<0&&(t=-t>e.length?0:e.length+t),0===(s=s>e.length?e.length:s)&&0===i.length)return[];if(1===s&&1===i.length)return[[e[t],e[t]=i[0]][0]];switch(t){case e.length-1:if(0===e.length)return n(e,i),[];if(s>=1)return[[e.pop()],n(e,i)][0];break;case 0:if(0===s)return r(i,e),[];if(1===s)return[[e.shift()],r(i,e)][0];break;case e.length:return n(e,i),[]}switch(i.length){case 0:return arguments.length>2?e.splice(t,s):e.splice(t);case 1:return e.splice(t,s,i[0]);case 2:return e.splice(t,s,i[0],i[1]);case 3:return e.splice(t,s,i[0],i[1],i[2]);case 4:return e.splice(t,s,i[0],i[1],i[2],i[3]);case 5:return e.splice(t,s,i[0],i[1],i[2],i[3],i[4]);default:return e.splice(t,s,...i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.splice=t.pop=t.push=t.shift=t.unshift=t.indexOf=void 0,t.indexOf=function(e,t){return 0===e.length?-1:t==t?e.indexOf(t):e.findIndex((e=>e!=e))},t.unshift=r,t.shift=function(e,t){if(t<0)throw new Error("Unexpected negative number");return void 0===t?[e.shift(),e]:[s(e,0,t),e]},t.push=n,t.pop=function(e,t){if(t<0)throw new Error("Unexpected negative number");return void 0===t?[e,e.pop()]:[e,s(e,e.length-t,t)]},t.splice=s},9888:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.template=t.inherit=t.merge=t.extend=t.overwrite=t.clone=t.assign=void 0;const n=r(5413),s=r(113),i=r(6876);function o(e){return function(t,...r){if((0,s.isPrimitive)(t))return t;for(let n=0;n<r.length;++n){const i=r[n];if(i===t)continue;if((0,s.isPrimitive)(i))continue;const o=Object.keys(i);for(let r=0;r<o.length;++r)e(o[r],t,i)}return t}}function c(e){return e instanceof Object?{}:(0,n.ObjectCreate)(null)}t.assign=o(((e,t,r)=>t[e]=r[e])),t.clone=o(((e,r,n)=>{switch((0,s.type)(n[e])){case"Array":return r[e]=n[e].slice();case"Object":return"Object"===(0,s.type)(r[e])?r[e]=(0,t.clone)(c(n[e]),n[e]):r[e]=n[e];default:return r[e]=n[e]}})),t.overwrite=o(((e,r,n)=>{switch((0,s.type)(n[e])){case"Array":default:return r[e]=n[e];case"Object":return"Object"===(0,s.type)(r[e])?(0,t.overwrite)(r[e],n[e]):r[e]=(0,t.overwrite)(c(n[e]),n[e])}})),t.extend=o(((e,r,n)=>{switch((0,s.type)(n[e])){case"undefined":return;case"Array":default:return r[e]=n[e];case"Object":return"Object"===(0,s.type)(r[e])?(0,t.extend)(r[e],n[e]):r[e]=(0,t.extend)(c(n[e]),n[e])}})),t.merge=o(((e,r,n)=>{switch((0,s.type)(n[e])){case"undefined":return;case"Array":return"Array"===(0,s.type)(r[e])?r[e]=(0,i.push)(r[e],n[e]):r[e]=n[e].slice();case"Object":return"Object"===(0,s.type)(r[e])?(0,t.merge)(r[e],n[e]):r[e]=(0,t.merge)(c(n[e]),n[e]);default:return r[e]=n[e]}})),t.inherit=o(((e,r,i)=>{switch((0,s.type)(i[e])){case"undefined":return;case"Array":return r[e]=i[e].slice();case"Object":return"Object"===(0,s.type)(r[e])?(0,t.inherit)(r[e],i[e]):r[e]=(0,n.ObjectCreate)(i[e]);default:return r[e]=i[e]}})),t.template=o},3669:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.Cancellation=void 0;const i=r(8312),o=r(6189),c=r(7704),a=r(1825),u=r(6192);class l{constructor(e){if(this[n]="Cancellation",this.state=0,this.reason=void 0,this.handlers=[],this[s]=new i.Internal,e)for(const t of e)t.register(this.cancel)}isAlive(){return 0===this.state}isCancelled(){return 1===this.state}isClosed(){return 2===this.state}register$(e){const{handlers:t}=this;return this.isAlive()||0!==t.length?(t.push(r),()=>{e=a.noop}):(this.isCancelled()&&r(this.reason),a.noop);function r(t){try{e(t)}catch(t){(0,u.causeAsyncException)(t)}}}get register(){return e=>this.register$(e)}cancel$(e){if(this.isAlive()){this.state=1,this.reason=e;for(let{handlers:t}=this,r=0;r<t.length;++r)t[r](e);this.handlers=[],this[i.internal].resolve(e)}}get cancel(){return e=>this.cancel$(e)}close$(e){this.isAlive()&&(this.state=2,this.reason=e,this.handlers=[],this[i.internal].reject(e))}get close(){return e=>this.close$(e)}get promise(){return e=>this.isCancelled()?i.AtomicPromise.reject(this.reason):i.AtomicPromise.resolve(e)}get maybe(){return e=>(0,o.Just)(e).bind((e=>this.isCancelled()?o.Nothing:(0,o.Just)(e)))}get either(){return e=>(0,c.Right)(e).bind((e=>this.isCancelled()?(0,c.Left)(this.reason):(0,c.Right)(e)))}}t.Cancellation=l,n=Symbol.toStringTag,s=i.internal,l.prototype.then=i.AtomicPromise.prototype.then,l.prototype.catch=i.AtomicPromise.prototype.catch,l.prototype.finally=i.AtomicPromise.prototype.finally},4778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Channel=void 0;const n=r(8312),s=r(9998),i=r(4110),o=()=>n.AtomicPromise.reject(new Error("Spica: Channel: Closed"));class c{constructor(e=0){this.capacity=e,this.buffer=new i.Queue,this.producers=new i.Queue,this.consumers=new i.Queue,this.alive=!0}close(e){if(!this.alive)return void e?.([]);const{buffer:t,producers:r,consumers:s}=this;for(this.alive=!1;!r.isEmpty()||!s.isEmpty();)r.pop()?.bind(o()),s.pop()?.bind(o());e&&n.AtomicPromise.all(t).then(e)}put(e){if(!this.alive)return o();const{capacity:t,buffer:r,producers:i,consumers:c}=this;switch(!0){case r.length<t:case!c.isEmpty():return r.push(e),c.pop()?.bind(r.pop()),n.AtomicPromise.resolve();default:return i.push(new s.AtomicFuture),i.peek(-1).then((()=>this.put(e)))}}take(){if(!this.alive)return o();const{buffer:e,producers:t,consumers:r}=this;switch(!0){case!e.isEmpty():const i=e.pop();return t.pop()?.bind(),n.AtomicPromise.resolve(i);case!t.isEmpty():r.push(new s.AtomicFuture);const o=r.peek(-1);return t.pop().bind(),o.then();default:return r.push(new s.AtomicFuture),r.peek(-1).then()}}get size(){return this.buffer.length}async*[Symbol.asyncIterator](){try{for(;this.alive;)yield this.take()}catch(e){if(this.alive)throw e}}}t.Channel=c},9522:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clock=t.now=void 0;const n=r(4110),s=r(6192);let i,o=0;t.now=function(e){if(void 0===i)t.clock.now((()=>i=void 0));else if(!e&&20!=o++)return i;return o=1,i=Date.now()},t.clock=new class extends Promise{constructor(){super((e=>e(void 0)));const e=Promise.resolve();return e.next=this.next,e.now=this.now,e}next(e){a||u(),t.clock.then(e)}now(e){a||u(),c.push(e)}};const c=new n.Queue;let a=!1;function u(){a=!0,t.clock.then(l)}function l(){for(let e;e=c.pop();)try{e()}catch(e){(0,s.causeAsyncException)(e)}a=!1}},6212:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(1311),t)},1934:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equal=void 0,t.equal=function(e,t){return e==e?e===t:t!=t}},7218:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Copropagator=void 0;const n=r(5413),s=r(8779),i=r(8312);class o extends s.Coroutine{constructor(e,t=(e=>e[0]),r){const o=(0,n.isArray)(e)?e:[...e];super((async function*(){return this.then((e=>{for(const t of o)t[s.Coroutine.exit](e)}),(e=>{const t=i.AtomicPromise.reject(e);for(const e of o)e[s.Coroutine.exit](t)})),i.AtomicPromise.all(o).then((e=>0===e.length?void this[s.Coroutine.terminate](new Error("Spica: Copropagator: No result")):void this[s.Coroutine.exit](t(e))),(e=>{this[s.Coroutine.terminate](e)})),i.never}),{delay:!1,...r})}}t.Copropagator=o},8779:(e,t,r)=>{"use strict";var n,s,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.isCoroutine=t.Coroutine=void 0;const c=r(5413),a=r(9522),u=r(8312),l=r(9998),h=r(4778),d=r(9152),p=r(1825),f=r(4110),m=r(6192),v=Symbol.for("spica/Coroutine.alive"),y=Symbol.for("spica/Coroutine.init"),g=Symbol.for("spica/Coroutine.exit"),w=Symbol.for("spica/Coroutine.terminate"),b=Symbol.for("spica/Coroutine.port"),S=Symbol.for("spica/coroutine::internal");class q{constructor(e,t={}){this[n]="Coroutine",this[s]=new u.Internal,this[i]=new O(this),this[S]=new P(t);let r=0;this[y]=async()=>{const t=this[S];if(!t.alive)return;if(0!==r)return;let n=p.noop;try{const s=e.call(this);for(;t.alive;){const{0:{0:e,1:i}}=1==++r?[[void 0,p.noop]]:await Promise.all([t.settings.capacity<0?[void 0,p.noop]:t.sendBuffer.take(),Promise.all([t.settings.resume(),t.settings.interval>0?(0,d.wait)(t.settings.interval):void 0])]);if(n=i,!t.alive)break;const o=await s.next(e);if(!t.alive)break;if(o.done)return t.alive=!1,n({...o}),t.recvBuffer.put({...o}),void t.result.bind(o);n({...o}),await t.recvBuffer.put({...o})}n(u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled")))}catch(e){n(u.AtomicPromise.reject(e)),this[q.terminate](e)}};const o=this[S];if(this[u.internal].resolve(o.result.then((({value:e})=>e))),void 0!==o.settings.trigger)for(const e of(0,c.isArray)(o.settings.trigger)?o.settings.trigger:[o.settings.trigger])if(!(e in this)||!this.hasOwnProperty(e))if(e in this)Object.defineProperty(this,e,{set(t){delete this[e],this[e]=t,this[y]()},get(){return delete this[e],this[y](),this[e]},enumerable:!0,configurable:!0});else{const t=Object.getOwnPropertyDescriptor(this,e)||{value:this[e],enumerable:!0,configurable:!0,writable:!0};Object.defineProperty(this,e,{set(r){Object.defineProperty(this,e,{...t,value:r}),this[y]()},get(){return this[e]},enumerable:!0,configurable:!0})}this[S].settings.run&&(this[S].settings.delay?a.clock.now(this[y]):this[y]())}get[(n=Symbol.toStringTag,s=u.internal,v)](){return this[S].alive}[g](e){this[S].alive&&u.AtomicPromise.resolve(e).then((e=>{const t=this[S];t.alive&&(t.alive=!1,t.recvBuffer.put({value:void 0,done:!0}),t.result.bind({value:e}))}),(e=>{const t=this[S];t.alive&&(t.alive=!1,t.recvBuffer.put({value:void 0,done:!0}),t.result.bind(u.AtomicPromise.reject(e)))}))}[w](e){return this[g](u.AtomicPromise.reject(e))}async*[Symbol.asyncIterator](){const e=this[S],t=this[q.port];for(;e.alive;){const e=await t.recv();if(e.done)return await e.value;yield e.value}return await(this)}}t.Coroutine=q,i=b,q.alive=v,q.init=y,q.exit=g,q.terminate=w,q.port=b,q.prototype.then=u.AtomicPromise.prototype.then,q.prototype.catch=u.AtomicPromise.prototype.catch,q.prototype.finally=u.AtomicPromise.prototype.finally;class P{constructor(e){this.opts=e,this.settings=(0,c.ObjectAssign)({run:!0,delay:!0,capacity:-1,interval:0,resume:p.noop,trigger:void 0},this.opts),this.alive=!0,this.reception=0,this.sendBuffer=this.settings.capacity>=0?new h.Channel(this.settings.capacity):void 0,this.recvBuffer=this.settings.capacity>=0?new h.Channel(0):new _,this.result=new l.AtomicFuture,this.result.finally((()=>{this.sendBuffer?.close((e=>{for(;e.length>0;){const{1:t}=e.shift();try{t(u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled")))}catch(e){(0,m.causeAsyncException)(e)}}})),this.recvBuffer.close()}))}}class O{constructor(e){this[S]={co:e}}ask(e){const t=this[S].co[S];if(!t.alive)return u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled"));if(t.settings.capacity<0)return u.AtomicPromise.reject(new Error("Spica: Coroutine: Overflowed"));t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=new l.AtomicFuture;return t.sendBuffer.put([e,r.bind]),++t.reception,Promise.all([r,t.recvBuffer.take()]).then((([e])=>e.done?t.result.then((({value:t})=>({...e,value:t}))):{...e}))}recv(){const e=this[S].co[S];return e.alive?(++e.reception,Promise.resolve(e.recvBuffer.take()).then((t=>t.done?e.result.then((({value:e})=>({...t,value:e}))):{...t}))):u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled"))}send(e){const t=this[S].co[S];if(!t.alive)return u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled"));if(t.settings.capacity<0)return u.AtomicPromise.reject(new Error("Spica: Coroutine: Overflowed"));t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=new l.AtomicFuture;return Promise.resolve(t.sendBuffer.put([e,r.bind]))}connect(e){const t=this[S].co[S];return t.alive?(async()=>{t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=e.call(this[S].co);let n;for(;;){const e=await r.next(n);if(e.done)return await e.value;n=(await this.ask(e.value)).value}})():u.AtomicPromise.reject(new Error("Spica: Coroutine: Canceled"))}}t.isCoroutine=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.constructor&&"symbol"==typeof e.constructor.alive&&"boolean"==typeof e[e.constructor.alive]&&"symbol"==typeof e.constructor.init&&"function"==typeof e[e.constructor.init]&&"symbol"==typeof e.constructor.exit&&"function"==typeof e[e.constructor.exit]&&"symbol"==typeof e.constructor.terminate&&"function"==typeof e[e.constructor.terminate]&&"symbol"==typeof e.constructor.port&&"object"==typeof e[e.constructor.port]};class _{constructor(){this[o]=new _.Internal}get alive(){return this[S].alive}close(e){if(!this.alive)return void e?.([]);const t=this[S],{consumers:r}=t;for(t.alive=!1;!r.isEmpty();)r.pop().bind(_.fail());e&&e([])}put(e){if(!this.alive)return _.fail();const{consumers:t}=this[S];for(;!t.isEmpty();)t.pop().bind(e);return u.AtomicPromise.resolve()}take(){if(!this.alive)return _.fail();const{consumers:e}=this[S];return e.push(new l.AtomicFuture),e.peek(-1).then()}}o=S,function(e){e.fail=()=>u.AtomicPromise.reject(new Error("Spica: Channel: Closed"));e.Internal=class{constructor(){this.alive=!0,this.consumers=new f.Queue}}}(_||(_={}))},4042:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uncurry=t.curry=void 0;const n=r(6876);function s(e,t,...r){let n;return r.length<t?(...i)=>s(n??=r.length?e.bind(void 0,...r):e,t-r.length,...i):e(...r)}t.curry=e=>s(e,e.length);function i(e){const t=e.length;return(...r)=>0===t||r.length<=t?e(...r):i(e(...(0,n.shift)(r,t)[0]))(...r)}t.uncurry=e=>i(e)},7704:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Either=t.Left=t.Right=void 0;const n=r(8312),s=r(4042),i=r(6876);class o{constructor(e){this.value=e}fmap(e){return new o(e(this.value))}ap(e){return u.ap(this,e)}bind(e){return e(this.extract())}join(){return this.value}extract(e,t){return void 0!==t?t(this.value):this.value}}class c{constructor(e){this.value=e}fmap(e){return this}ap(e){return this}bind(e){return this}join(){return this}extract(e){if(void 0!==e)return e(this.value);throw this.value}}function a(e){return new o(e)}var u;t.Right=a,t.Left=function(e){return new c(e)},function(e){e.fmap=function(e,t){return t.fmap(e)},e.pure=a,e.ap=function e(t,r){return r?t.bind((e=>r.fmap((0,s.curry)(e)))):r=>e(t,r)},e.Return=e.pure,e.bind=function(e,t){return t.bind(e)},e.sequence=function(t){return Array.isArray(t)?t.reduce(((e,t)=>e.bind((e=>t.fmap((t=>(0,i.push)(e,[t])))))),e.Return([])):t.extract((e=>n.AtomicPromise.resolve(new c(e))),(t=>n.AtomicPromise.resolve(t).then(e.Return)))}}(u||(t.Either=u={}))},6192:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.suppressAsyncException=t.causeAsyncException=void 0;const n=new(r(7345).Stack);t.causeAsyncException=function(e){n.isEmpty()?Promise.reject(e):n.peek().push(e)},t.suppressAsyncException=function(e){return t=>(n.push([]),e((e=>{n.pop(),t(e)})))}},1825:(e,t)=>{"use strict";function r(){}Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.fix=t.id=t.clear=t.singleton=void 0,t.singleton=function(e){let t;return function(...n){return e===r||(t=e.call(this,...n),e=r),t}},t.clear=function(e){return(...t)=>{e(...t)}},t.id=function(e){return e},t.fix=function(e){return t=>{const r=e(t);return t===r||r!=r?r:e(r)}},t.noop=r},9998:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.AtomicFuture=t.Future=void 0;const i=r(8312),o=Symbol("spica/future::state");class c extends Promise{static get[Symbol.species](){return Promise}constructor(e=!0){let t;super((e=>t=e)),this.strict=e,this[o]={pending:!0,resolve:t}}bind$(e){if(this[o].pending)this[o].pending=!1,this[o].resolve(e);else if(this.strict)throw new Error("Spica: Future: Cannot rebind the value");return this}get bind(){return e=>this.bind$(e)}}t.Future=c;class a{constructor(e=!0){this.strict=e,this[n]="Promise",this[s]=new i.Internal}bind$(e){if(this[i.internal].isPending())this[i.internal].resolve(e);else if(this.strict)throw new Error("Spica: AtomicFuture: Cannot rebind the value");return this}get bind(){return e=>this.bind$(e)}}t.AtomicFuture=a,n=Symbol.toStringTag,s=i.internal,a.prototype.then=i.AtomicPromise.prototype.then,a.prototype.catch=i.AtomicPromise.prototype.catch,a.prototype.finally=i.AtomicPromise.prototype.finally},518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(3394);const n=globalThis;n.global=n,t.default=n},3394:()=>{"use strict"},3719:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiHeap=t.Heap=void 0;const n=r(4609),s=r(6925);class i{constructor(e=i.max,t){this.cmp=e,this.array={},this.$length=0,this.stable=t?.stable??!1}get length(){return this.$length}isEmpty(){return void 0!==this.array[0]}peek(){return this.array[0]}insert(e,t){1===arguments.length&&(t=e);const r=this.array,n=r[this.$length]={index:++this.$length,order:t,value:e};return c(this.cmp,r,this.$length),n}replace(e,t){if(1===arguments.length&&(t=e),0===this.$length)return void this.insert(e,t);const r=this.array,n=r[0],s=n.value;return n.order=t,n.value=e,a(this.cmp,r,1,this.$length,this.stable),s}extract(){if(0===this.$length)return;const e=this.array[0];return this.delete(e),e.value}delete(e){const t=this.array,r=e.index;if(t[r-1]!==e)throw new Error("Invalid node");return u(t,r,this.$length--),o(this.cmp,t,r,this.$length,this.stable),t[this.$length]=void 0,e.value}update(e,t,r){const n=this.array,s=e.index;if(n[s-1]!==e)throw new Error("Invalid node");1===arguments.length&&(t=e.order),arguments.length>=3&&(e.value=r),0!==this.cmp(e.order,e.order=t)&&o(this.cmp,n,s,this.$length,this.stable)}clear(){this.array={},this.$length=0}}function o(e,t,r,n,s){if(0===n)return!1;switch(r){case 1:return a(e,t,r,n,s);case n:return c(e,t,r);default:return c(e,t,r)||a(e,t,r,n,s)}}function c(e,t,r){const n=t[r-1].order;let s=!1;for(;r>1;){const i=r/2|0;if(e(t[i-1].order,n)<=0)break;u(t,r,i),r=i,s||=!0}return s}function a(e,t,r,n,s){let i=!1;for(;r<n;){const o=2*r,c=2*r+1;let a=r;if(o<=n){const r=e(t[o-1].order,t[a-1].order);(s?r<=0:r<0)&&(a=o)}if(c<=n){const r=e(t[c-1].order,t[a-1].order);(s?r<=0:r<0)&&(a=c)}if(a===r)break;u(t,r,a),r=a,i||=!0}return i}function u(e,t,r){if(t===r)return;const n=t-1,s=r-1,i=e[n],o=e[s];e[n]=o,e[s]=i,i.index=r,o.index=t}t.Heap=i,i.max=(e,t)=>e>t?-1:e<t?1:0,i.min=(e,t)=>e>t?1:e<t?-1:0;class l extends n.List{constructor(e,t){super(),this.order=e,this.heap=t.insert(this,e)}}class h{constructor(e,t,r){this.list=e,this.order=t,this.value=r,this.next=void 0,this.prev=void 0}}class d{constructor(e=d.max,t){this.cmp=e,this.dict=new Map,this.list=(0,s.memoize)((e=>new l(e,this.heap)),this.dict),this.$length=0,this.clean=t?.clean??!0,this.heap=new i(this.cmp)}get length(){return this.$length}isEmpty(){return this.heap.isEmpty()}peek(){return this.heap.peek()?.value.head}insert(e,t){1===arguments.length&&(t=e),++this.$length;const r=new h(this.list(t),t,e);return r.list.push(r),r}extract(){if(0===this.$length)return;--this.$length;const e=this.heap.peek()?.value,t=e.shift().value;return 0===e.length&&(this.heap.extract(),this.clean&&this.dict.delete(e.order)),t}delete(e){if(void 0===e.next)throw new Error("Invalid node");const t=e.list;return--this.$length,1===t.length&&(this.heap.delete(t.heap),this.clean&&this.dict.delete(t.order)),t.delete(e).value}update(e,t,r){const n=e.list;if(void 0===n)throw new Error("Invalid node");return arguments.length>=3&&(e.value=r),0===this.cmp(n.order,t)?e:(this.delete(e),this.insert(e.value,t))}clear(){this.heap.clear(),this.dict.clear(),this.$length=0}}t.MultiHeap=d,d.max=i.max,d.min=i.min},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=void 0,t.compose=function(e,...t){return t.reduce(((e,t)=>(Object.getOwnPropertyNames(t.prototype).filter((t=>!(t in e.prototype))).forEach((r=>e.prototype[r]=t.prototype[r])),Object.getOwnPropertyNames(t).filter((t=>!(t in e))).forEach((r=>e[r]=t[r])),e)),e)}},8553:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(4974),t)},4609:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(1952),t)},1311:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;class r{constructor(){this.length=0,this.head=void 0}get tail(){return this.head?.next}get last(){return this.head?.prev}insert(e,t){if(1==++this.length)return this.head=e.next=e.prev=e;const r=e.next=t??this.head,n=e.prev=r.prev;return r.prev=n.next=e}delete(e){if(0==--this.length)this.head=void 0;else{const{next:t,prev:r}=e;e===this.head&&(this.head=t),r.next=t,t.prev=r}return e.next=e.prev=void 0,e}unshift(e){return this.head=this.insert(e,this.head)}push(e){return this.insert(e,this.head)}shift(){if(0!==this.length)return this.delete(this.head)}pop(){if(0!==this.length)return this.delete(this.head.prev)}clear(){this.length=0,this.head=void 0}*[Symbol.iterator](){for(let e=this.head;void 0!==e&&(yield e,e=e.next,e!==this.head););}flatMap(e){const t=[];for(let r=this.head;void 0!==r;){const n=e(r);switch(n.length){case 0:break;case 1:t.push(n[0]);break;default:for(let e=n.length,r=0;r<e;++r)t.push(n[r])}if(r=r.next,r===this.head)break}return t}find(e){for(let t=this.head;void 0!==t;){if(e(t))return t;if(t=t.next,t===this.head)break}}}t.List=r,function(e){e.Node=class{constructor(){this.next=void 0,this.prev=void 0}}}(r||(t.List=r={}))},4974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HList=void 0;const n=r(6876);t.HList=function(...e){return e.reduceRight(((e,t)=>e.add(t)),s)};const s=new class{add(e){return new i(e,this)}reverse(){return[]}tuple(){return[]}};class i{constructor(e,t){this.head=e,this.tail=t}add(e){return new i(e,this)}modify(e){return this.tail.add(e(this.head))}fold(e){return this.tail.modify((t=>e(this.head,t)))}unfold(e){return this.add(e(this.head))}reverse(){return this.tuple().reverse()}tuple(){return(0,n.unshift)([this.head],this.tail.tuple())}}},1952:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;class r{constructor(){this.length=0,this.head=void 0,this.last=void 0}get tail(){return this.head?.next}insert(e,t){if(void 0===t)return this.push(e);if(t===this.head)return this.unshift(e);if(1==++this.length)return this.head=this.last=e;const r=e.next=t,n=e.prev=r.prev;return r.prev=n.next=e}delete(e){if(0==--this.length)this.head=this.last=void 0;else{const{next:t,prev:r}=e;void 0===r?this.head=t:r.next=t,void 0===t?this.last=r:t.prev=r}return e.next=e.prev=void 0,e}unshift(e){return 1==++this.length?this.head=this.last=e:(e.next=this.head,this.head=this.head.prev=e)}push(e){return 1==++this.length?this.head=this.last=e:(e.prev=this.last,this.last=this.last.next=e)}shift(){if(0!==this.length)return this.delete(this.head)}pop(){if(0!==this.length)return this.delete(this.last)}clear(){this.length=0,this.head=this.last=void 0}*[Symbol.iterator](){for(let e=this.head;void 0!==e;e=e.next)yield e}flatMap(e){const t=[];for(let r=this.head;void 0!==r;r=r.next){const n=e(r);switch(n.length){case 0:break;case 1:t.push(n[0]);break;default:for(let e=n.length,r=0;r<e;++r)t.push(n[r])}}return t}find(e){for(let t=this.head;void 0!==t;t=t.next)if(e(t))return t}}t.List=r,function(e){e.Node=class{constructor(){this.next=void 0,this.prev=void 0}}}(r||(t.List=r={}))},6189:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Maybe=t.Nothing=t.Just=void 0;const n=r(8312),s=r(4042),i=r(6876);class o{constructor(e){this.value=e}fmap(e){return new o(e(this.value))}ap(e){return u.ap(this,e)}bind(e){return e(this.value)}join(){return this.value}guard(e){return e?this:u.mzero}extract(e,t){return void 0!==t?t(this.value):this.value}}function c(e){return new o(e)}t.Just=c;const a=new class{fmap(e){return this}ap(e){return this}bind(e){return this}join(){return this}guard(e){return this}extract(e){if(void 0!==e)return e();throw new Error("Spica: Maybe: Nothing value is extracted")}};var u;t.Nothing=a,function(e){e.fmap=function(e,t){return t.fmap(e)},e.pure=c,e.ap=function e(t,r){return r?t.bind((e=>r.fmap((0,s.curry)(e)))):r=>e(t,r)},e.Return=e.pure,e.bind=function(e,t){return t.bind(e)},e.sequence=function(t){return Array.isArray(t)?t.reduce(((e,t)=>e.bind((e=>t.fmap((t=>(0,i.push)(e,[t])))))),e.Return([])):t.extract((()=>n.AtomicPromise.resolve(e.mzero)),(t=>n.AtomicPromise.resolve(t).then(e.Return)))},e.mzero=a,e.mplus=function(e,t){return e.extract((()=>t),(()=>e))}}(u||(t.Maybe=u={}))},6925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=t.memoize=void 0;const n=r(5413),s=r(1934);t.memoize=function(e,t,r){switch("object"==typeof t&&(r=t,t=void 0),t??=(...e)=>e[0],!0){case(0,n.isArray)(r):return function(e,t,r){return(...n)=>{const s=t(...n);let i=r[s];return void 0!==i||(i=e(...n),r[s]=i),i}}(e,t,r);case r?.constructor===Object:return function(e,t,r){let n=!1;return(...s)=>{const i=t(...s);let o=r[i];return void 0!==o||n&&i in r||(o=e(...s),n||=void 0===o,r[i]=o),o}}(e,t,r);default:return function(e,t,r){let n=!1;return(...s)=>{const i=t(...s);let o=r.get(i);return void 0!==o||n&&r.has(i)||(o=e(...s),n||=void 0===o,r.add?.(i,o)??r.set(i,o)),o}}(e,t,r??new Map)}},t.reduce=function(e,t=((...e)=>e[0])){let r,n={};return(...i)=>{const o=t(...i);return(0,s.equal)(n,o)||(n=o,r=e(...i)),r}}},4455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Applicative=void 0;const n=r(6562),s=r(4042);class i extends n.Functor{}t.Applicative=i,function(e){e.ap=function e(t,r){return r?t.bind((e=>r.fmap((0,s.curry)(e)))):r=>e(t,r)}}(i||(t.Applicative=i={}))},6562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Functor=void 0;const n=r(2939);class s extends n.Lazy{}t.Functor=s,function(e){e.fmap=function(e,t){return t.fmap(e)}}(s||(t.Functor=s={}))},2939:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lazy=void 0;t.Lazy=class{constructor(e){this.thunk=e,this.$memory=void 0}evaluate(){return this.$memory??=this.thunk()}}},862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Monad=void 0;const n=r(4455);class s extends n.Applicative{}t.Monad=s,function(e){e.bind=function(e,t){return t.bind(e)}}(s||(t.Monad=s={}))},6978:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonadPlus=void 0;const n=r(862);class s extends n.Monad{}t.MonadPlus=s,s||(t.MonadPlus=s={})},6276:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sequence=void 0,r(654),r(2877),r(6931),r(9698),r(6117),r(9090),r(2486),r(5834),r(8136),r(1171),r(1875),r(8096),r(6633),r(8122),r(1634),r(3204),r(5990),r(4909),r(8462),r(968),r(5720),r(2685),r(5759),r(2104),r(722),r(4973),r(3007),r(7854),r(9453),r(7698),r(39),r(6921),r(9526),r(1135),r(4845),r(406),r(9664),r(3511),r(2003),r(7519),r(3367),r(2395),r(1380),r(9642),r(9731);var n=r(1472);Object.defineProperty(t,"Sequence",{enumerable:!0,get:function(){return n.Sequence}})},1472:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sequence=void 0;const n=r(6978);class s extends n.MonadPlus{constructor(e){super(i),this.cons=e}[Symbol.iterator](){let e=()=>this.iterate();return{next(){const t=e();return e=s.Thunk.iterator(t),{done:!s.isIterable(t),value:s.Thunk.value(t)}}}}}function i(){throw new Error("Spica: Sequence: Invalid thunk call")}t.Sequence=s,s||(t.Sequence=s={}),function(e){let t,r,n,s;!function(t){t.cons=function(t,r){switch(arguments.length){case 0:return[];case 1:return[t];case 2:return[t,r];default:throw e.Exception.invalidConsError(arguments)}}}(t=e.Data||(e.Data={})),function(e){e.value=function(e){return e[0]},e.iterator=function(e){return e[1]},e.index=function(e){return e[2]}}(r=e.Thunk||(e.Thunk={})),function(t){t.done=()=>[void 0,t.done,-1],t.when=function t(n,s,i){return e.isIterable(n)?i(n,(()=>t(r.iterator(n)(),s,i))):s(n)}}(n=e.Iterator||(e.Iterator={})),e.isIterable=function(e){return r.iterator(e)!==n.done},function(e){e.invalidConsError=function(e){return console.error(e,e.length,e[0],e[1]),new TypeError("Spica: Sequence: Invalid parameters of cons")},e.invalidDataError=function(e){return console.error(e),new TypeError("Spica: Sequence: Invalid data")},e.invalidThunkError=function(e){return console.error(e),new TypeError("Spica: Sequence: Invalid thunk")}}(s=e.Exception||(e.Exception={}))}(s||(t.Sequence=s={}))},39:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{ap(e){return n.Sequence.ap(this,e)}})},6921:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{bind(e){return n.Sequence.concat(this.fmap(e))}})},5759:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{drop(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>n.Sequence.Thunk.index(t)<e?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},3007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{dropUntil(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t))?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{dropWhile(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t))?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},4909:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{extract(){const e=[];let t=()=>this.iterate();for(;;){const r=t();if(!n.Sequence.isIterable(r))return e;e.push(n.Sequence.Thunk.value(r)),t=n.Sequence.Thunk.iterator(r)}}})},9664:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{filter(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t),n.Sequence.Thunk.index(t))?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):s()))))}})},4845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{filterM(e){return n.Sequence.from([0]).bind((()=>{const t=this.extract();if(0===t.length)return n.Sequence.from([[]]);{const r=t.shift();return e(r).bind((s=>s?0===t.length?n.Sequence.from([[r]]):n.Sequence.from(t).filterM(e).fmap((e=>[r,...e])):0===t.length?n.Sequence.from([[]]):n.Sequence.from(t).filterM(e)))}}))}})},7698:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{fmap(e){return new n.Sequence(((t=(()=>this.iterate()))=>n.Sequence.Iterator.when(t(),(()=>n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(t)),n.Sequence.Thunk.iterator(t))))))}})},2003:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{foldr(e,t){return new n.Sequence(((r=(()=>this.reduce().iterate()))=>n.Sequence.Iterator.when(r(),(()=>n.Sequence.Data.cons(t)),(r=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(r),n.Sequence.resume(n.Sequence.Thunk.iterator(r)).foldr(e,t))))))).bind((e=>e))}})},7519:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{group(e){return new n.Sequence((([t,r]=[()=>this.iterate(),[]],s)=>n.Sequence.Iterator.when(t(),(()=>0===r.length?s():s(r)),((t,i)=>0===r.length||e(r[0],n.Sequence.Thunk.value(t))?(r.push(n.Sequence.Thunk.value(t)),i()):s(r,[n.Sequence.Thunk.iterator(t),[n.Sequence.Thunk.value(t)]])))))}})},3367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{inits(){return n.Sequence.mappend(n.Sequence.from([[]]),this.scanl(((e,t)=>[...e,t]),[]).dropWhile((e=>0===e.length)))}})},8462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{iterate(){return this.iterate_()}iterate_(e,t=0){const r=this.cons(e,n.Sequence.Data.cons);switch(r.length){case 0:return[void 0,n.Sequence.Iterator.done,-1];case 1:return[r[0],()=>n.Sequence.Iterator.done(),t];case 2:return[r[0],()=>this.iterate_(r[1],t+1),t];default:throw n.Sequence.Exception.invalidDataError(r)}}})},9526:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{join(){return n.Sequence.concat(this)}})},406:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{map(e){return new n.Sequence(((t=(()=>this.iterate()))=>n.Sequence.Iterator.when(t(),(()=>n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(t),n.Sequence.Thunk.index(t)),n.Sequence.Thunk.iterator(t))))))}})},1135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{mapM(e){return n.Sequence.from([0]).bind((()=>{const t=this.extract();if(0===t.length)return n.Sequence.mempty;{const r=t.shift();return e(r).bind((r=>0===t.length?n.Sequence.from([[r]]):n.Sequence.from(t).mapM(e).fmap((e=>[r,...e]))))}}))}})},968:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472),s=r(7386),i=(0,r(6925).memoize)((e=>new Map));(0,s.compose)(n.Sequence,class extends n.Sequence{memoize(){return new n.Sequence((([e,t]=[0,i(this)],r)=>n.Sequence.Iterator.when(t.get(e)||t.set(e,e>0&&t.has(e-1)?n.Sequence.Thunk.iterator(t.get(e-1))():this.iterate()).get(e),(()=>r()),(s=>r(n.Sequence.Thunk.value(s),[e+1,t])))))}})},9731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);function s(e,t){return n.Sequence.Iterator.when(e.iterate(),(()=>n.Sequence.mempty),(e=>new n.Sequence(((r,i)=>n.Sequence.Iterator.when(e,(()=>i()),(e=>{const r=n.Sequence.Thunk.value(e),o=n.Sequence.resume(n.Sequence.Thunk.iterator(e)).memoize();return i(t.permutations().foldr(((e,t)=>function(e,t){return c((e=>e),e,t)[1]}(n.Sequence.from(e),t)),s(o,n.Sequence.mappend(n.Sequence.from([r]),t))));function c(e,t,s){return n.Sequence.Iterator.when(t.iterate(),(()=>[o,s]),(t=>{const i=n.Sequence.Thunk.value(t),{0:o,1:a}=c((t=>e(n.Sequence.mappend(n.Sequence.from([i]),t))),n.Sequence.resume(n.Sequence.Thunk.iterator(t)),s);return[n.Sequence.mappend(n.Sequence.from([i]),o),n.Sequence.mappend(n.Sequence.from([e(n.Sequence.mappend(n.Sequence.from([r]),n.Sequence.mappend(n.Sequence.from([i]),o))).extract()]),a)]}))}})))).bind((e=>e))))}(0,r(7386).compose)(n.Sequence,class extends n.Sequence{permutations(){return n.Sequence.from([0]).bind((()=>{const e=this.extract();return 0===e.length?n.Sequence.mempty:n.Sequence.from([e])})).bind((e=>n.Sequence.mappend(n.Sequence.from([e]),s(n.Sequence.from(e),n.Sequence.mempty))))}})},5720:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{reduce(){return new n.Sequence((([e,t]=[0,new Map],r)=>n.Sequence.Iterator.when(t.get(e)||t.set(e,e>0&&t.has(e-1)?n.Sequence.Thunk.iterator(t.get(e-1))():this.iterate()).get(e),(()=>r()),(s=>r(n.Sequence.Thunk.value(s),[e+1,t])))))}})},3511:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{scanl(e,t){return new n.Sequence((([r,s,i]=[t,()=>this.iterate(),0])=>n.Sequence.Iterator.when(s(),(()=>0===i?n.Sequence.Data.cons(t):n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(r=e(r,n.Sequence.Thunk.value(t)),[r,n.Sequence.Thunk.iterator(t),n.Sequence.Thunk.index(t)+1])))))}})},1380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{segs(){return n.Sequence.mappend(this.foldr(((e,t)=>t.take(1).bind((r=>n.Sequence.mappend(n.Sequence.from([n.Sequence.mappend(n.Sequence.from([[e]]),n.Sequence.from(r).map((t=>[e,...t])))]),t)))),n.Sequence.from([n.Sequence.from([])])).bind((e=>e)),n.Sequence.from([[]]))}})},7854:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{sort(e){return n.Sequence.from(this.extract().sort(e))}})},9642:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);function s(e){return n.Sequence.Iterator.when(e.iterate(),(()=>n.Sequence.mempty),(e=>n.Sequence.mappend(n.Sequence.from([[n.Sequence.Thunk.value(e)]]),new n.Sequence(((t,r)=>n.Sequence.Iterator.when(e,(()=>r()),(e=>r(s(n.Sequence.resume(n.Sequence.Thunk.iterator(e))).foldr(((t,r)=>n.Sequence.mappend(n.Sequence.mappend(n.Sequence.from([t]),n.Sequence.from([[n.Sequence.Thunk.value(e),...t]])),r)),n.Sequence.mempty)))))).bind((e=>e)))))}(0,r(7386).compose)(n.Sequence,class extends n.Sequence{subsequences(){return n.Sequence.mappend(n.Sequence.from([[]]),n.Sequence.from([0]).bind((()=>s(this))))}})},2395:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{tails(){return n.Sequence.mappend(n.Sequence.from(this.extract().map(((e,t,r)=>r.slice(t)))),n.Sequence.from([[]]))}})},2685:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{take(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(e>0?t():n.Sequence.Iterator.done(),(()=>r()),(t=>n.Sequence.Thunk.index(t)+1<e?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):r(n.Sequence.Thunk.value(t))))))}})},4973:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{takeUntil(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),(t=>e(n.Sequence.Thunk.value(t))?r(n.Sequence.Thunk.value(t)):r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},2104:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{takeWhile(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),(t=>e(n.Sequence.Thunk.value(t))?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):r()))))}})},9453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{unique(){const e=new Set;return this.filter((t=>!e.has(t)&&!!e.add(t)))}})},6117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static concat(e){return new n.Sequence((([t,r]=[()=>e.iterate(),n.Sequence.Iterator.done],s)=>n.Sequence.Iterator.when(t(),(()=>s()),((e,t)=>(r=r===n.Sequence.Iterator.done?()=>n.Sequence.Thunk.value(e).iterate():r,n.Sequence.Iterator.when(r(),(()=>(r=n.Sequence.Iterator.done,t())),(t=>s(n.Sequence.Thunk.value(t),[()=>e,n.Sequence.Thunk.iterator(t)]))))))))}})},6931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static cycle(e){return new n.Sequence((function t([r,n]=[e[Symbol.iterator](),0],s){const i=r.next();return i.done?t([e[Symbol.iterator](),n+1],s):s(i.value,[r,n+1])})).reduce()}})},2486:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static difference(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>n.Sequence.Iterator.when(i(),(()=>o()),(e=>o(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),((e,t)=>n.Sequence.Iterator.when(i(),(()=>o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Iterator.done])),(s=>{const c=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(s));return c<0?o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),()=>s]):c>0?o(n.Sequence.Thunk.value(s),[()=>e,n.Sequence.Thunk.iterator(s)]):(i=()=>n.Sequence.Thunk.iterator(s)(),t())}))))))}})},2877:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static from(e){return new n.Sequence((([t,r]=[e[Symbol.iterator](),0],n)=>{const s=t.next();return s.done?n():n(s.value,[t,r+1])})).reduce()}})},8136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static intersect(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>o()),((e,t)=>n.Sequence.Iterator.when(i(),(()=>o()),((s,c)=>{const a=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(s));return a<0?(i=()=>s,t()):a>0?c():o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(s)])}))))))}})},1634:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static mappend(e,t){return n.Sequence.mconcat([e,t])}})},8122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static mconcat(e){return[...e].reduce(((e,t)=>function(e,t){return new n.Sequence((([r,s]=[()=>e.iterate(),()=>t.iterate()],i)=>n.Sequence.Iterator.when(r(),(()=>n.Sequence.Iterator.when(s(),(()=>i()),(e=>i(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),(e=>i(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),s])))))}(e,t)),n.Sequence.mempty)}})},6633:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(1472);(0,r(7386).compose)(s.Sequence,((n=class extends s.Sequence{}).mempty=new s.Sequence(((e,t)=>t())),n))},5990:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(1472);(0,r(7386).compose)(s.Sequence,((n=class extends s.Sequence{}).mplus=s.Sequence.mappend,n))},3204:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(1472);(0,r(7386).compose)(s.Sequence,((n=class extends s.Sequence{}).mzero=s.Sequence.mempty,n))},1171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static pure(e){return new n.Sequence(((t,r)=>r(e)))}})},9698:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5413),s=r(1472);(0,r(7386).compose)(s.Sequence,class extends s.Sequence{static random(e=(()=>(0,n.random)())){return"function"==typeof e?s.Sequence.from(new s.Sequence(((t,r)=>r(e(),t)))):this.random().map((t=>e[(0,n.floor)(t*e.length)]))}})},654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static resume(e){return new n.Sequence(((t=e,r)=>n.Sequence.Iterator.when(t(),(()=>r()),(e=>r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.iterator(e))))))}})},1875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static Return(e){return new n.Sequence(((t,r)=>r(e)))}})},8096:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static sequence(e){return e.reduce(((e,t)=>e.fmap((e=>n.Sequence.mappend(e,t)))),n.Sequence.Return(n.Sequence.from([])))}})},5834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static union(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>n.Sequence.Iterator.when(i(),(()=>o()),(e=>o(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),(e=>n.Sequence.Iterator.when(i(),(()=>o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Iterator.done])),(t=>{const s=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(t));return s<0?o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),()=>t]):s>0?o(n.Sequence.Thunk.value(t),[()=>e,n.Sequence.Thunk.iterator(t)]):o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(t)])}))))))}})},9090:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1472);(0,r(7386).compose)(n.Sequence,class extends n.Sequence{static zip(e,t){return new n.Sequence((([r,s]=[()=>e.iterate(),()=>t.iterate()],i)=>n.Sequence.Iterator.when(r(),(()=>i()),(e=>n.Sequence.Iterator.when(s(),(()=>i()),(t=>i([n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(t)],[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(t)])))))))}})},5995:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observation=void 0;const n=r(5413),s=r(4609),i=r(6876),o=r(1825),c=r(6192);class a{constructor(e){this.value=e,this.next=void 0,this.prev=void 0}}class u{constructor(e,t){this.name=e,this.parent=t,this.mid=0,this.sid=0,this.monitors=new s.List,this.subscribers=new s.List,this.index=new Map,this.children=new s.List}reset(e){switch(e){case this.monitors:this.mid=0;for(let t=e.head,r=e.length;t&&r--;t=t.next)t.value.id=++this.mid;return;case this.subscribers:this.sid=0;for(let t=e.head,r=e.length;t&&r--;t=t.next)t.value.id=++this.sid;return;default:throw new Error("Unreachable")}}clear(e=!1){const{monitors:t,subscribers:r,index:n,children:s}=this,i=[];for(let t=s.head,r=s.length;t&&r--;)if(t.value.clear(!0)){const r=t.next;e?i.push(t.value.name):n.delete(t.value.name),s.delete(t),t=r}else t=t.next;if(s.length)for(;i.length;)n.delete(i.pop());return r.clear(),0===t.length&&0===s.length}}function l(e,t){for(let r=e.length;r--;){if(t(e[r]))return e[r];e.pop()}}t.Observation=class{constructor(e){this.node=new u(void 0),this.limit=e?.limit??10}monitor(e,t,r={}){if("function"!=typeof t)throw new Error(`Spica: Observation: Invalid listener: ${t}`);const s=this.seek(e,0),i=s.monitors;if(i.length===this.limit)throw new Error("Spica: Observation: Exceeded max listener limit");s.mid===n.MAX_SAFE_INTEGER&&s.reset(i);const c=i.push(new a({id:++s.mid,type:0,namespace:e,listener:t,options:r}));return(0,o.singleton)((()=>{i.delete(c)}))}on(e,t,r={}){if("function"!=typeof t)throw new Error(`Spica: Observation: Invalid listener: ${t}`);const s=this.seek(e,0),i=s.subscribers;if(i.length===this.limit)throw new Error("Spica: Observation: Exceeded max listener limit");s.sid===n.MAX_SAFE_INTEGER&&s.reset(i);const c=i.push(new a({id:++s.sid,type:1,namespace:e,listener:t,options:r}));return(0,o.singleton)((()=>{i.delete(c)}))}once(e,t){return this.on(e,t,{once:!0})}off(e,t){if(t){const r=this.seek(e,1)?.subscribers,n=r?.find((e=>e.value.listener===t));n&&r?.delete(n)}else this.seek(e,1)?.clear()}emit(e,t,r){this.drain(e,t,r)}reflect(e,t){let r;return this.emit(e,t,((e,t)=>r=t)),r}relay(e){if(this.relaies??=new WeakSet,this.relaies.has(e))throw new Error("Spica: Observation: Relay source is already registered");return this.relaies.add(e),e.monitor([],((e,t)=>{this.emit(t,e)}))}refs(e){const t=this.seek(e,1);return void 0===t?[]:this.listenersBelow(t).reduce(((e,t)=>(0,i.push)(e,t.flatMap((e=>[e.value])))),[])}drain(e,t,r){let n=this.seek(e,1);const s=[];for(let i=n?this.listenersBelow(n,1):[],o=0;o<i.length;++o){const n=i[o];if(0===n.length)continue;const a=[],u=n.last.value.id;let h,d=0;for(let i=n.head;i&&d<i.value.id&&i.value.id<=u;){d=i.value.id;const o=i.value;o.options.once&&n.delete(i);try{const n=o.listener(t,e);r&&s.push(n)}catch(e){(0,c.causeAsyncException)(e)}(void 0!==i.next||void 0!==i.prev||n.head===i)&&a.push(i),i=i.next??h?.next??l(a,(e=>e.next))??n.head,h=i?.prev}}n??=this.seek(e,2);for(let r=this.listenersAbove(n,0),s=0;s<r.length;++s){const n=r[s];if(0===n.length)continue;const i=[],o=n.last.value.id;let a,u=0;for(let r=n.head;r&&u<r.value.id&&r.value.id<=o;){u=r.value.id;const s=r.value;s.options.once&&n.delete(r);try{s.listener(t,e)}catch(e){(0,c.causeAsyncException)(e)}(void 0!==r.next||void 0!==r.prev||n.head===r)&&i.push(r),r=r.next??a?.next??l(i,(e=>e.next))??n.head,a=r?.prev}}if(r)try{r(t,s)}catch(e){(0,c.causeAsyncException)(e)}}seek(e,t){let r=this.node;for(let n=0;n<e.length;++n){const s=e[n],{index:i,children:o}=r;let c=i.get(s);if(void 0===c){switch(t){case 1:return;case 2:return r}c=new u(s,r),i.set(s,c),o.push(new a(c))}r=c}return r}listenersAbove({parent:e,monitors:t}){const r=[t];for(;e;)r.push(e.monitors),e=e.parent;return r}listenersBelow(e,t){return this.listenersBelow$(e,t,[])[0]}listenersBelow$({monitors:e,subscribers:t,index:r,children:n},s,i){if(1===s)i.push(t);else i.push(e,t);let o=0;for(let e=n.head,t=n.length;e&&t--;){const t=this.listenersBelow$(e.value,s,i)[1];if(o+=t,0===t){const t=e.next;r.delete(e.value.name),n.delete(e),e=t}else e=e.next}return[i,e.length+t.length+o]}}},8312:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.isPromiseLike=t.Internal=t.AtomicPromise=t.internal=void 0;const i=r(5413),o=r(1825);t.internal=Symbol.for("spica/promise::internal");class c{static get[(n=Symbol.toStringTag,Symbol.species)](){return c}static all(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e],o=Array(s.length);let c=!1,a=0;for(let e=0;!c&&e<s.length;++e){const i=s[e];if(h(i)){if(d(i)){const{status:r}=i[t.internal];switch(r.state){case 2:o[e]=r.value,++a;continue;case 3:return n(r.reason)}}i.then((t=>{o[e]=t,++a,a===s.length&&r(o)}),(e=>{n(e),c=!0}))}else o[e]=i,++a}a===s.length&&r(o)}))}static race(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e];for(let e=0;e<s.length;++e){const i=s[e];if(!h(i))return r(i);if(d(i)){const{status:e}=i[t.internal];switch(e.state){case 2:return r(e.value);case 3:return n(e.reason)}}}let o=!1;for(let e=0;!o&&e<s.length;++e){s[e].then((e=>{r(e),o=!0}),(e=>{n(e),o=!0}))}}))}static allSettled(e){return new c((r=>{const n=(0,i.isArray)(e)?e:[...e],s=Array(n.length);let o=0;for(let e=0;e<n.length;++e){const i=n[e];if(h(i)){if(d(i)){const{status:r}=i[t.internal];switch(r.state){case 2:s[e]={status:"fulfilled",value:r.value},++o;continue;case 3:s[e]={status:"rejected",reason:r.reason},++o;continue}}i.then((t=>{s[e]={status:"fulfilled",value:t},++o,o===n.length&&r(s)}),(t=>{s[e]={status:"rejected",reason:t},++o,o===n.length&&r(s)}))}else s[e]={status:"fulfilled",value:i},++o}o===n.length&&r(s)}))}static any(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e],o=Array(s.length);let c=!1,a=0;for(let e=0;!c&&e<s.length;++e){const i=s[e];if(!h(i))return r(i);if(d(i)){const{status:n}=i[t.internal];switch(n.state){case 2:return r(n.value);case 3:o[e]=n.reason,++a;continue}}i.then((e=>{r(e),c=!0}),(t=>{o[e]=t,++a,a===s.length&&n(new AggregateError(o,"All promises were rejected"))}))}a===s.length&&n(new AggregateError(o,"All promises were rejected"))}))}static resolve(e){const r=new c(o.noop);return r[t.internal].resolve(e),r}static reject(e){const r=new c(o.noop);return r[t.internal].reject(e),r}constructor(e){if(this[n]="Promise",this[s]=new a,e!==o.noop)try{e((e=>{this[t.internal].resolve(e)}),(e=>{this[t.internal].reject(e)}))}catch(e){this[t.internal].reject(e)}}then(e,r){const n=new c(o.noop);return this[t.internal].then(n[t.internal],e,r),n}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.AtomicPromise=c,s=t.internal;class a{constructor(){this.status={state:0},this.fulfillReactions=[],this.rejectReactions=[]}isPending(){return 0===this.status.state}resolve(e){if(this.isPending()){if(!h(e))return this.status={state:2,value:e},this.resume();if(d(e))return e[t.internal].then(this);this.status={state:1,promise:e},e.then((e=>{this.status={state:2,value:e},this.resume()}),(e=>{this.status={state:3,reason:e},this.resume()}))}}reject(e){if(this.isPending())return this.status={state:3,reason:e},this.resume()}then(e,t,r){const{status:n,fulfillReactions:s,rejectReactions:i}=this;switch(n.state){case 2:if(0!==s.length)break;return l(e,!0,t,n.value);case 3:if(0!==i.length)break;return l(e,!1,r,n.reason)}s.push({internal:e,state:!0,procedure:t}),i.push({internal:e,state:!1,procedure:r})}resume(){const{status:e,fulfillReactions:t,rejectReactions:r}=this;switch(e.state){case 0:case 1:return;case 2:if(0!==r.length&&(this.rejectReactions=[]),0===t.length)return;return u(t,e.value),void(this.fulfillReactions=[]);case 3:if(0!==t.length&&(this.fulfillReactions=[]),0===r.length)return;return u(r,e.reason),void(this.rejectReactions=[])}}}function u(e,t){for(let r=0;r<e.length;++r){const{internal:n,state:s,procedure:i}=e[r];l(n,s,i,t)}}function l(e,t,r,n){if(null==r)return t?e.resolve(n):e.reject(n);try{e.resolve(r(n))}catch(t){e.reject(t)}}function h(e){return null!=e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then}function d(e){return t.internal in e}t.Internal=a,t.isPromiseLike=h,t.never=new class e extends Promise{static get[Symbol.species](){return e}constructor(){super(o.noop)}then(){return this}catch(){return this}finally(){return this}}},4110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiQueue=t.PriorityQueue=t.Queue=void 0;const n=r(3719),s=r(6925);class i{constructor(){this.head=new o(16),this.tail=this.head,this.count=0}get length(){return this.head===this.tail?this.head.length:this.head.length+this.count+this.tail.length}isEmpty(){return this.head.isEmpty()}peek(e=0){return 0===e?this.head.peek(0):this.tail.peek(-1)}push(e){const t=this.tail;t.isFull()&&(t.next.isEmpty()?this.tail=t.next:this.tail=t.next=new o(2048,t.next),this.head!==t&&(this.count+=t.size)),this.tail.push(e)}pop(){const e=this.head,t=e.pop();if(e.isEmpty()&&!e.next.isEmpty()){const t=this.tail;t.next!==e&&(t.next.next=t.next,t.next=e),this.head=e.next,this.head!==t&&(this.count-=e.next.size)}return t}clear(){this.head=this.tail=new o(16),this.count=0}*[Symbol.iterator](){for(;!this.isEmpty();)yield this.pop()}}t.Queue=i;class o{constructor(e,t){this.size=e,this.array=Array(this.size),this.mask=this.array.length-1,this.head=0,this.tail=0,this.empty=!0,this.next=t??this}get length(){return this.tail>=this.head?this.empty?0:this.tail-this.head||this.size:this.array.length-this.head+this.tail}isEmpty(){return this.empty}isFull(){return this.tail===this.head&&!this.empty}peek(e=0){return e>=0?this.array[this.head+e&this.mask]:this.array[this.tail+e&this.mask]}push(e){this.array[this.tail]=e,this.tail=this.tail+1&this.mask,this.empty=!1}pop(){if(this.empty)return;const e=this.array[this.head];return this.array[this.head]=void 0,this.head=this.head+1&this.mask,this.empty=this.tail===this.head,e}}class c{constructor(e=c.max,t=!0){this.clean=t,this.dict=new Map,this.queue=(0,s.memoize)((e=>{const t=new i;return t[c.priority]=e,this.heap.insert(t,e),t}),this.dict),this.$length=0,this.heap=new n.Heap(e)}get length(){return this.$length}isEmpty(){return 0===this.$length}peek(e){return 0===arguments.length?this.heap.peek()?.value.peek():this.dict.get(e)?.peek()}push(e,t){++this.$length,this.queue(e).push(t)}pop(e){if(0===this.$length)return;--this.$length;const t=0===arguments.length?this.heap.peek().value:this.dict.get(e),r=t?.pop();return t?.isEmpty()&&(this.heap.extract(),this.clean&&this.dict.delete(t[c.priority])),r}clear(){this.heap.clear(),this.dict.clear(),this.$length=0}*[Symbol.iterator](){for(;!this.isEmpty();)yield this.pop()}}t.PriorityQueue=c,c.priority=Symbol("priority"),c.max=n.Heap.max,c.min=n.Heap.min;class a{constructor(e){if(this.dict=new Map,e)for(const{0:t,1:r}of e)this.set(t,r)}get length(){return this.dict.size}isEmpty(){return 0===this.dict.size}peek(e){return this.dict.get(e)?.peek()}push(e,t){let r=this.dict.get(e);r?r.push(t):(r=new i,r.push(t),this.dict.set(e,r))}pop(e){return this.dict.get(e)?.pop()}clear(){this.dict=new Map}take(e,t){if(void 0===t)return this.pop(e);const r=this.dict.get(e),n=[];for(;r&&!r.isEmpty()&&t--;)n.push(r.pop());return n}ref(e){let t=this.dict.get(e);return t||(t=new i,this.dict.set(e,t),t)}get size(){return this.length}get(e){return this.peek(e)}set(e,t){return this.push(e,t),this}has(e){return this.dict.has(e)}delete(e){return this.dict.delete(e)}*[Symbol.iterator](){for(const{0:e,1:t}of this.dict)for(;!t.isEmpty();)yield[e,t.pop()]}}t.MultiQueue=a},2027:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;const n=r(5413),s=r(6876),i=Symbol("empty"),o=e=>e===i?void 0:e,c=Object.freeze(Array(100).fill(i));class a{constructor(){this.array=Array(16),this.head=0,this.tail=0,this.$length=0,this.excess=0}get length(){return this.$length}at(e){const t=this.array;if(e>=0){if(e>=this.$length)return;return o(t[(this.head-1+e)%t.length])}if(!(-e>this.$length))return this.tail+e>=0?o(t[this.tail+e]):o(t[t.length+this.tail+e])}set(e,t,r){const n=this.array;if(e>=0){if(e>=this.$length)throw new RangeError("Invalid index");e=(this.head-1+e)%n.length}else{if(-e>this.$length)throw new RangeError("Invalid index");e=this.tail+e>=0?this.tail+e:n.length+this.tail+e}const s=o(n[e]);return n[e]=r?r(s,t):t,s}push(e){const t=this.array;let{head:r,tail:n}=this;n=this.tail=function(e,t,r){return t===r&&1!==e?1:t+1}(r,n,t.length),r=this.head||=n,r===n&&0!==this.$length&&((0,s.splice)(t,n-1,0,...c),r=this.head+=c.length),t[n-1]=e,++this.$length}unshift(e){const t=this.array;let{head:r,tail:n}=this;r=this.head=function(e,t,r){return 0===e||1===e?t===r?r+1:r:e-1}(r,n,t.length),n=this.tail||=r,r===n&&0!==this.$length&&((0,s.splice)(t,r,0,...c),r=this.head+=c.length),t[r-1]=e,++this.$length}pop(){if(0===this.$length)return;const e=this.array,t=this.tail-1,r=o(e[t]);return e[t]=i,0==--this.$length?this.head=this.tail=0:this.tail=1===this.tail?e.length:this.tail-1,r}shift(){if(0===this.$length)return;const e=this.array,t=this.head-1,r=o(e[t]);return e[t]=i,0==--this.$length?this.head=this.tail=0:this.head=this.head===e.length?1:this.head+1,r}splice(e,t,...r){const i=this.array;if(this.excess>100&&i.length-this.$length>200?((0,s.splice)(i,0,100-(0,s.splice)(i,this.tail,100).length),this.excess-=100):-this.excess>2*i.length&&(this.excess=i.length),e=e<0?(0,n.max)(0,this.$length+e):e<=this.$length?e:this.$length,t=(0,n.min)((0,n.max)(t,0),this.$length-e),0===r.length){if(0===t)return[];switch(e){case 0:if(1===t)return[this.shift()];break;case this.$length-1:if(1===t)return[this.pop()];break;case this.$length:return[]}}if(e=(e=(this.head||1)-1+e)>i.length?e%i.length:e,this.excess+=r.length-t,this.$length+=r.length-t,this.head<=this.tail)return this.tail+=r.length-t,(0,s.splice)(i,e,t,...r);if(e<this.tail)return this.head+=r.length-t,this.tail+=r.length-t,(0,s.splice)(i,e,t,...r);const o=(0,n.min)(t,i.length-e),c=(0,s.splice)(i,e,o,...(0,s.splice)(r,0,o));return c.push(...(0,s.splice)(i,0,t-c.length,...r)),c}clear(){this.array=Array(16),this.$length=this.head=this.tail=0}includes(e){return this.array.includes(e)}relational(e){return-1===e?-1:e+1>=this.head?e+1-this.head:this.array.length-this.head+e}indexOf(e){return this.relational((0,s.indexOf)(this.array,e))}findIndex(e){return this.relational(this.array.findIndex((t=>t!==i&&e(t))))}find(e){return o(this.array.find((t=>t!==i&&e(t))))}toArray(){return this.head<=this.tail?this.array.slice((this.head||1)-1,this.tail):this.array.slice((this.head||1)-1).concat(this.array.slice(0,this.tail))}*[Symbol.iterator](){for(let e=0;e<this.$length;++e)yield this.at(e)}}t.Ring=a},7727:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.router=void 0;const n=r(4252),s=r(1825),i=r(6925);function o(e){const{match:t}=o.helpers(),r=Object.keys(e).reverse();for(const e of r){if("/"!==e[0])throw new Error(`Spica: Router: Pattern must start with "/": ${e}`);if(/\s/.test(e))throw new Error(`Spica: Router: Pattern must not have whitespace: ${e}`)}return n=>{const s=n.slice(0,n.search(/[?#]|$/));for(const i of r)if(t(i,s))return e[i](n);throw new Error("Spica: Router: No matches found")}}t.router=o,function(e){e.helpers=function(){const e=(0,i.memoize)((function e(t){return n.Sequence.from(function(e){const t=[],r=[],n={"]":"[",")":"(","}":"{"},s=[];let i=0,o=e.length,c="";e:for(;o;)for(const t of e.match(/\\.?|[\[\](){}]|[^\\\[\](){}]+|$/g)){switch(t){case"":if(0!==r.length){e=c,r.splice(0,r.length),o=e.length,c="";continue e}a();continue;case"[":case"(":throw new Error(`Spica: Router: Invalid pattern: ${e}`);case"]":case")":r.at(-1)===n[t]&&r.pop()&&s.pop(),c+=t;continue;case"{":if(o-c.length===s[i]&&++i)break;0===r.length&&a(),"["!==r.at(-1)&&r.push(t)&&s.push(o-c.length),c+=t;continue;case"}":r[0]===n[t]&&r.pop()&&s.pop(),c+=t,0===r.length&&a();continue}c+=t}return 0===t.length&&t.push(""),t;function a(){o-=c.length,c&&t.push(c),c=""}}(t).map((t=>t[0]+t.slice(-1)==="{}"?function(e){const t=[],r=[],n={"]":"[",")":"(","}":"{"};let s="";for(const t of e.match(/\\.?|[,\[\](){}]|[^\\,\[\](){}]+|$/g)){switch(t){case"":i();continue;case",":0===r.length?i():s+=t;continue;case"[":case"(":case"{":s+=t,"["!==r.at(-1)&&r.push(t);continue;case"]":case")":case"}":r.at(-1)===n[t]&&r.pop(),s+=t;continue}s+=t}return t;function i(){t.push(s),s=""}}(t.slice(1,-1)).flatMap(e):[t]))).mapM(n.Sequence.from).extract().map((e=>e.join("")))}));function t(e,n,s=0,i=0){if(s+i===0&&e.length>0&&n.length>0&&"."===n[0]&&["?","*"].includes(e[0][0]))return!1;for(;s<e.length;++s,++i){const c=e[s];if("**"===c)return!0;if("**/"===c){let r=e.length-i;for(let t=i;t<e.length;++t)"**/"===e[t]&&--r;for(let o=n.length-r;o>=i;--o)if(t(e,n,s+1,o))return!0;return!1}{if(i===n.length)return!1;const e="/"!==c.slice(-1)&&"/"===n[i].slice(-1)&&n[i].slice(0,-1)||n[i];if(!r(o(c),0,e,0))return!1}}return!0}function r(e,t,n,s){for(;t<e.length;++t){const i=e[t],o=n.slice(s);switch(i){case"?":switch(o){case"":case"/":return!1;default:++s;continue}case"*":switch(o){case"":case"/":continue}for(let i=n.length;i>=s;--i)if(r(e,t+1,n,i))return!0;return!1;default:if(o.length<i.length||o.slice(0,i.length)!==i)return!1;s+=i.length;continue}}return s===n.length}function o(e){const t=[],r=[],n={"]":"[",")":"(","}":"{"};let s="";for(const t of e.match(/\\.?|[*?\[\](){}]|[^\\*?\[\](){}]+|$/g)){switch(t){case"":i();continue;case"*":case"?":0===r.length&&i(),s+=t,0===r.length&&i();continue;case"[":case"(":case"{":s+=t,"["!==r.at(-1)&&r.push(t);continue;case"]":case")":case"}":if("}"===t&&"{"===r[0])throw new Error(`Spica: Router: Invalid pattern: ${e}`);r.at(-1)===n[t]&&r.pop(),s+=t;continue}s+="\\"===t[0]?t.slice(1):t}return t;function i(){s&&t.push(s),s=""}}const c=(0,i.memoize)((0,s.fix)((e=>e.replace(/((?:^|\/)\*)\*(?:\/\*\*)*(?=\/|$)|\*+(\?+)?/g,"$1$2*"))));return{match:function(r,n){const s=/\/|[^/]+\/?/g,i=n.match(s)??[];for(const n of e(r)){if(t(c(n).match(s)??[],i))return!0}return!1},expand:e,cmp:t}}}(o||(t.router=o={}))},4252:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(6276),t)},7345:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0;class r{constructor(){this.array=[]}get length(){return this.array.length}isEmpty(){return 0===this.array.length}peek(e=0){return 0===e?this.array.at(-1):this.array[0]}push(e){this.array.push(e)}pop(){return this.array.pop()}clear(){this.array=[]}*[Symbol.iterator](){for(;!this.isEmpty();)yield this.pop()}}t.Stack=r},7339:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Supervisor=void 0;const s=r(5413),i=r(9522),o=r(8779),c=r(5995),a=r(8312),u=r(9998),l=r(1825),h=r(2027),d=r(6192);class p extends o.Coroutine{static get instances(){return this.hasOwnProperty("$instances")?this.$instances:this.$instances=new Set}static get status(){if(this.hasOwnProperty("$status"))return this.$status;const{instances:e}=this;return this.$status={get instances(){return e.size},get processes(){return[...e].reduce(((e,t)=>e+t.workers.size),0)}}}static clear(e){for(;this.instances.size>0;)for(const t of this.instances)t.terminate(e)}constructor(e={}){if(super((async function*(){return await this.state}),{delay:!1}),this.state=new u.AtomicFuture,this.settings={name:"",capacity:1/0,timeout:1/0,destructor:l.noop,scheduler:i.clock.next,resource:10},this.workers=new Map,this.alive=!0,this.available=!0,this[n]={ask:()=>{throw new Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port`)},recv:()=>{throw new Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port`)},send:()=>{throw new Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port`)},connect:()=>{throw new Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port`)}},this.scheduled=!1,this.messages=new h.Ring,(0,s.ObjectAssign)(this.settings,e),this.name=this.settings.name,this.constructor===p)throw new Error(`Spica: Supervisor: <${this.name}>: Cannot instantiate abstract classes`);this.constructor.instances.add(this)}destructor(e){for(this.available=!1,this.clear(e),Object.freeze(this.workers);this.messages.length>0;){const{0:e,1:t,4:r}=this.messages.shift(),n=e[Symbol.iterator]().next().value;r&&clearTimeout(r),this.$events?.loss.emit([n],[n,t])}this.alive=!1,this.constructor.instances.delete(this),Object.freeze(this),this.settings.destructor(e),this.state.bind(void 0===e?void 0:a.AtomicPromise.reject(e))}get events(){return this.$events??={init:new c.Observation,exit:new c.Observation,loss:new c.Observation}}throwErrorIfNotAvailable(){if(!this.available)throw new Error(`Spica: Supervisor: <${this.name}>: Cannot use terminated supervisors`)}register(e,t,r){if(this.throwErrorIfNotAvailable(),(0,o.isCoroutine)(t)){const n=t[t.constructor.port],s={init:e=>e,main:(e,t,r)=>n.ask(e).then((({value:e,done:n})=>n&&void r()||[e,t])),exit:e=>{t[t.constructor.terminate](e)}};this.constructor.standalone.add(s);const i=this.register(e,s,r);return t.catch(i),i}if(function(e){return"AsyncGeneratorFunction"===e[Symbol.toStringTag]}(t)){let n;return this.register(e,{init:(e,r)=>(n=t(e,r),n.next().catch(r),e),main:(e,t,r)=>a.AtomicPromise.resolve(n.next(e)).then((({value:e,done:n})=>n&&void r()||[e,t])),exit:l.noop},r)}if(function(e){return"GeneratorFunction"===e[Symbol.toStringTag]}(t)){let n;return this.register(e,{init:(e,r)=>(n=t(e,r),n.next(),e),main:(e,t,r)=>{const{value:s,done:i}=n.next(e);return i&&r(),[s,t]},exit:l.noop},r)}if("function"==typeof t)return this.register(e,{init:e=>e,main:t,exit:l.noop},r);if(this.workers.has(e))throw new Error(`Spica: Supervisor: <${this.name}/${e}>: Cannot register another process with tha same name`);this.schedule();const n=new m(e,t,r,this,(()=>{this.schedule()}),this.constructor.standalone.has(t),this.$events,(()=>{this.workers.get(e)===n&&this.workers.delete(e)}));return this.workers.set(e,n),n.terminate}call(e,t,r,n=this.settings.timeout){if("function"!=typeof r)return new a.AtomicPromise(((n,s)=>{this.call(e,t,((e,t)=>e?s(e):n(t)),r)}));for(this.throwErrorIfNotAvailable(),this.messages.push(["string"==typeof e?[e]:new f(this.workers,e),t,r,Date.now()+n,0]);this.messages.length>(this.available?this.settings.capacity:0);){const{0:e,1:t,2:r,4:n}=this.messages.shift();n&&clearTimeout(n);const s=e[Symbol.iterator]().next().value;this.$events?.loss.emit([s],[s,t]);try{r(new Error(`Spica: Supervisor: <${this.name}>: Message overflowed`),void 0)}catch(e){(0,d.causeAsyncException)(e)}}0!==this.messages.length&&(this.throwErrorIfNotAvailable(),this.schedule(),n>0&&n!==1/0&&(this.messages.at(-1)[4]=setTimeout((()=>{this.schedule()}),n+3)))}cast(e,t,r=this.settings.timeout){this.throwErrorIfNotAvailable();const n=Date.now()+r;let s;for(e of"string"==typeof e?[e]:new f(this.workers,e))if(s=this.workers.get(e)?.call([t,n]))break;if(s)return s;const i="string"==typeof e?e:void 0;this.$events?.loss.emit([i],[i,t])}refs(e){return void 0===e?[...this.workers.values()].map(t):this.workers.has(e)?[t(this.workers.get(e))]:[];function t(e){return[e.name,e.process,e.state,e.terminate]}}kill(e,t){return!!this.available&&(!!this.workers.has(e)&&this.workers.get(e).terminate(t))}clear(e){for(;this.workers.size>0;)for(const t of this.workers.values())t.terminate(e)}terminate(e){return!!this.available&&(this.destructor(e),this[o.Coroutine.exit](void 0),!0)}[o.Coroutine.terminate](e){this.terminate(e)}schedule(){if(!this.available||this.scheduled||0===this.messages.length)return;this.scheduled=!0;const e=new u.AtomicFuture(!1);e.finally((()=>{this.scheduled=!1,this.deliver()})),this.settings.scheduler.call(void 0,e.bind),this.settings.scheduler===requestAnimationFrame&&setTimeout(e.bind,1e3)}deliver(){if(!this.available)return;const e=Date.now();for(let t=this.messages.length,r=0;this.available&&r<t;++r){if(this.settings.resource-(Date.now()-e)<=0)return void this.schedule();const{0:n,1:s,2:i,3:o,4:c}=this.messages.at(r);let a,u;for(u of"string"==typeof n?[n]:n){if(Date.now()>o)break;if(a=this.workers.get(u)?.call([s,o]))break}if(a||!(Date.now()<o))if(this.messages.splice(r,1),--r,--t,c&&clearTimeout(c),a)a.then((e=>{i(void 0,e)}),(()=>{i(new Error(`Spica: Supervisor: <${this.name}>: Process failed`),void 0)}));else{this.$events?.loss.emit([u],[u,s]);try{i(new Error(`Spica: Supervisor: <${this.name}>: Message expired`),void 0)}catch(e){(0,d.causeAsyncException)(e)}}}}}t.Supervisor=p,n=o.Coroutine.port,p.standalone=new WeakSet;class f{constructor(e,t){this.workers=e,this.selector=t}[Symbol.iterator](){return this.selector(this.workers.keys())[Symbol.iterator]()}}class m{constructor(e,t,r,n,s,i,o,c){this.name=e,this.process=t,this.state=r,this.sv=n,this.schedule=s,this.events=o,this.destructor_=c,this.alive=!0,this.available=!0,this.initiated=!1,this.terminate=e=>!!this.alive&&(this.destructor(e),!0),i&&this.init()}destructor(e){this.alive=!1,this.available=!1,Object.freeze(this);try{this.destructor_()}catch(e){(0,d.causeAsyncException)(e)}this.initiated&&this.exit(e)}init(){this.initiated=!0,this.events?.init.emit([this.name],[this.name,this.process,this.state]),this.state=this.process.init(this.state,this.terminate)}exit(e){try{this.process.exit(e,this.state),this.events?.exit.emit([this.name],[this.name,this.process,this.state,e])}catch(t){this.events?.exit.emit([this.name],[this.name,this.process,this.state,e]),this.sv.terminate(t)}}call([e,t]){if(this.available)return new a.AtomicPromise(((r,n)=>{(0,s.isFinite)(t)&&setTimeout((()=>{n(new Error)}),t-Date.now()),this.available=!1,this.initiated||(this.init(),this.alive)?a.AtomicPromise.resolve(this.process.main(e,this.state,this.terminate)).then(r,n):n()})).then((([e,t])=>(this.alive&&(this.schedule(),this.state=t,this.available=!0),e))).catch((e=>{throw this.schedule(),this.terminate(e),e}))}}},525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cothrottle=t.debounce=t.throttle=void 0;const n=r(9522),s=r(6192);t.throttle=function(e,t,r=1){let n=0,i=[];return function o(c){1===r?i=[c]:(i.length===r&&i.shift(),i.push(c)),0===n&&(n=setTimeout((async()=>{const e=i;i=[];try{await t.call(this,e[e.length-1],e)}catch(e){(0,s.causeAsyncException)(e)}n=0,i.length>0&&o.call(this,i.pop())}),e))}},t.debounce=function(e,t,r=1){let n=0,i=[],o=!0;return function c(a){1===r?i=[a]:(i.length===r&&i.shift(),i.push(a)),0===n&&(n=setTimeout((()=>{n=0,setTimeout((async()=>{if(0!==n)return;if(!o)return;const e=i;i=[],o=!1;try{await t.call(this,e[e.length-1],e)}catch(e){(0,s.causeAsyncException)(e)}o=!0,i.length>0&&c.call(this,i.pop())}),e)}),e))}},t.cothrottle=function(e,t,r){return async function*(){let s=(0,n.now)();for await(const i of e())yield i,t-((0,n.now)()-s)>0||(await r(),s=(0,n.now)())}}},9152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wait=t.captureTimers=t.setRepeatTimer=t.setTimer=void 0;const n=r(4609),s=r(9522),i=r(1825);class o extends n.List.Node{constructor(e){super(),this.value=e}}function c(e,t){const r=(r,n,s)=>{let c,a=setTimeout((async function t(){c=[await n()],e&&(a=setTimeout(t,r))}),r);const u=(0,i.singleton)((()=>{clearTimeout(a),t&&l&&(l.next||l.prev||l===t.head)&&t.delete(l),c&&s?.(c[0])})),l=t?.push(new o(u));return u};return t?r.clear=()=>{for(;0!==t.length;)t.shift().value()}:r.group=()=>c(e,new n.List),r}t.setTimer=c(!1),t.setRepeatTimer=c(!0),t.captureTimers=function(e){const t=setTimeout(i.noop);if(clearTimeout(t),"number"!=typeof t)throw new Error("Timer ID must be a number");return r=>e((e=>{const n=setTimeout(i.noop);r(e),clearTimeout(n);for(let e=t;e<n;++e)clearTimeout(e)}))},t.wait=function(e){return 0===e?s.clock:new Promise((t=>{setTimeout(t,e)}))}},108:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TLRU=void 0;const n=r(5413),s=r(6212);class i{constructor(e,t){this.key=e,this.value=t,this.next=void 0,this.prev=void 0}}class o{constructor(e,t=2,r=0,n=!0,i=t>=100){this.capacity=e,this.demotion=t,this.window=r,this.retrial=n,this.pure=i,this.dict=new Map,this.list=new s.List,this.handV=void 0,this.handG=void 0,this.count=0}get length(){return this.list.length}get size(){return this.list.length}extend(){const{list:e}=this;this.count=-(0,n.max)((e.length-this.count)*this.demotion/100|0,e.length*this.window/100-this.count|0,this.demotion&&1)}replace(e,t){const{dict:r,list:n}=this;if(this.handV??=n.last,this.handV===this.handG&&this.count>=0&&this.extend(),this.count>=0||this.handV===n.last||!this.retrial){const n=this.handV;r.delete(n.key),r.set(e,n),n.key=e,n.value=t}else{const s=n.last;r.delete(s.key),r.set(e,s),s.key=e,s.value=t,this.escape(s),n.delete(s),this.handG!==n.head?n.insert(s,this.handG):n.unshift(s),this.handV=s,this.handG=s}this.count<0&&(this.handG=this.handG!==n.head?this.handG.prev:void 0),this.handV!==this.handG&&(this.handV=this.handV.prev),this.handV===n.last||-1===this.count?(this.handV=n.last,this.count=0):++this.count}evict(){const{list:e}=this,t=this.handV??e.last;if(void 0!==t)return this.delete(t.key),[t.key,t.value]}add(e,t){const{dict:r,list:n}=this;if(n.length===this.capacity)this.replace(e,t);else{const s=new i(e,t);r.set(e,s),this.pure&&void 0!==this.handG?n.insert(s,this.handG.next):void 0!==this.handV?n.insert(s,this.handV.next):n.unshift(s)}return!0}set(e,t){const r=this.dict.get(e);return void 0===r?this.add(e,t):r.value=t,this}escape(e){const{list:t}=this;if(1===t.length)return this.handV=void 0,this.handG=void 0,void(this.count=0);e===this.handV&&(this.handV=this.handV.prev),e===this.handG&&(this.handG=this.handG.prev)}get(e){const{dict:t,list:r}=this,n=t.get(e);if(void 0!==n)return n!==r.head&&(this.escape(n),r.delete(n),r.unshift(n)),this.handG??=n,n.value}has(e){return this.dict.has(e)}delete(e){const{dict:t,list:r}=this,n=t.get(e);return void 0!==n&&(n===this.handG&&n===r.head&&(this.handG=void 0),this.escape(n),r.delete(n),t.delete(e))}clear(){this.dict.clear(),this.list.clear(),this.handV=void 0,this.handG=void 0,this.count=0}*[Symbol.iterator](){for(const{key:e,value:t}of this.list)yield[e,t]}}t.TLRU=o},8888:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(108),t)},2871:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tuple=void 0,t.tuple=function(...e){return e}},113:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrimitive=t.is=t.type=void 0;const n=r(5413),s=Object.prototype,i=Array.prototype;t.type=function(e){const t=typeof e;switch(t){case"function":return"Function";case"object":if(null===e)return"null";const r=e[Symbol.toStringTag];if(r)return r;switch((0,n.ObjectGetPrototypeOf)(e)){case i:return"Array";case s:return"Object";default:return e?.constructor?.name||(0,n.toString)(e).slice(8,-1)}default:return t}},t.is=function(e,t){switch(e){case"null":return null===t;case"array":return(0,n.isArray)(t);case"object":return null!==t&&typeof t===e;default:return typeof t===e}},t.isPrimitive=function(e){switch(typeof e){case"function":return!1;case"object":return null===e;default:return!0}}},1904:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.ReadonlyURL=t.standardize=void 0;const n=r(1094);var s=r(1094);Object.defineProperty(t,"standardize",{enumerable:!0,get:function(){return s.standardize}});var i=r(1094);Object.defineProperty(t,"ReadonlyURL",{enumerable:!0,get:function(){return i.ReadonlyURL}});t.URL=class{constructor(e,t){e=e.trim(),t=t?.trim(),this.url=new n.ReadonlyURL(e,t),this.params=void 0,this.source=e,this.base=t}get href(){return this.params?.toString().replace(/^(?=.)/,`${this.url.href.slice(0,-this.url.query.length-this.url.fragment.length||this.url.href.length)}?`).concat(this.fragment)??this.url.href}get resource(){return this.params?.toString().replace(/^(?=.)/,`${this.url.href.slice(0,-this.url.query.length-this.url.fragment.length||this.url.href.length)}?`)??this.url.resource}get origin(){return this.url.origin}get scheme(){return this.url.scheme}get protocol(){return this.url.protocol}get username(){return this.url.username}get password(){return this.url.password}get host(){return this.url.host}get hostname(){return this.url.hostname}get port(){return this.url.port}get path(){return this.params?.toString().replace(/^(?=.)/,`${this.pathname}?`)??this.url.path}get pathname(){return this.url.pathname}get search(){return this.params?.toString().replace(/^(?=.)/,"?")??this.url.search}get query(){return this.params?.toString().replace(/^(?=.)/,"?")??this.url.query}get hash(){return this.url.hash}get fragment(){return this.url.fragment}get searchParams(){return this.params??=new URLSearchParams(this.search)}toString(){return this.url.toString()}toJSON(){return this.url.toJSON()}}},1094:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadonlyURL=t.encode=t.standardize=void 0,r(518);const n=r(6925),s=r(8888);function i(e){e=e.replace(/[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?<![\uD800-\uDBFF])[\uDC00-\uDFFF]/g,"");const{1:t,2:r}=e.match(/^([^#]*)(.*)$/s),{1:n,2:s}=t.replace(/(?:%(?:[0-9][a-f]|[a-f][0-9a-fA-F]|[A-F][0-9a-f]))+/g,(e=>e.toUpperCase())).match(/^([^?]*)(.*)$/s);return""+n.replace(/(?:[^%[\]]|%(?![0-9A-F]{2}))+/gi,encodeURI)+s.replace(/(?!^)(?:[^%=&]|%(?![0-9A-F]{2}))+/gi,encodeURIComponent)+r}t.standardize=function(e,t){const{origin:r,protocol:n,href:s}=new o(e,t);return i(e="null"===r?n.toLowerCase()+s.slice(n.length):r.toLowerCase()+s.slice(r.length))},t.encode=i;class o{constructor(e,t){switch(e=e.trim(),t=t?.trim(),e.slice(0,e.lastIndexOf("://",9)+1).toLowerCase()){case"http:":case"https:":t=void 0;break;default:switch(t?.slice(0,t.lastIndexOf("://",9)+1).toLowerCase()){case"http:":case"https:":const r=t.indexOf("#");r>-1&&(t=t.slice(0,r));const n=t.indexOf("?");n>-1&&""!==e&&"#"!==e[0]&&(t=t.slice(0,n))}}this.cache=o.get(e,t),this.params=void 0,this.source=e,this.base=t}get href(){return this.cache.href??=this.cache.url.href}get resource(){return this.cache.resource??=this.href.slice(0,this.href.search(/[?#]|$/))+this.search}get origin(){return this.cache.origin??=this.cache.url.origin}get scheme(){return this.cache.scheme??=this.protocol.slice(0,-1)}get protocol(){return this.cache.protocol??=this.cache.url.protocol}get username(){return this.cache.username??=this.cache.url.username}get password(){return this.cache.password??=this.cache.url.password}get host(){return this.cache.host??=this.cache.url.host}get hostname(){return this.cache.hostname??=this.cache.url.hostname}get port(){return this.cache.port??=this.cache.url.port}get path(){return this.cache.path??=`${this.pathname}${this.search}`}get pathname(){return this.cache.pathname??=this.cache.url.pathname}get search(){return this.cache.search??=this.cache.url.search}get query(){return this.cache.query??=this.search||"?"===this.href[this.href.length-this.fragment.length-1]&&"?"||""}get hash(){return this.cache.hash??=this.cache.url.hash}get fragment(){return this.cache.fragment??=this.hash||"#"===this.href[this.href.length-1]&&"#"||""}get searchParams(){return this.params??=new c(this.search)}toString(){return this.href}toJSON(){return this.href}}t.ReadonlyURL=o,o.get=(0,n.memoize)(((e,t)=>({url:new r.g.URL(e,t)})),((e,t="")=>`${t.indexOf("\n")>-1?t.replace(/\n+/g,""):t}\n${e}`),new s.TLRU(1e4));class c extends URLSearchParams{append(e,t){this.sort()}delete(e,t){this.sort()}set(e,t){this.sort()}sort(){throw new Error("Spica: URL: Cannot use mutable methods with ReadonlyURLSearchParams")}}},2076:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeXMLHttpRequest=t.default=t.Pjax=void 0;var n=r(9869);Object.defineProperty(t,"Pjax",{enumerable:!0,get:function(){return n.GUI}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.GUI}});var s=r(3026);Object.defineProperty(t,"FakeXMLHttpRequest",{enumerable:!0,get:function(){return s.FakeXMLHttpRequest}})},7430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.route=t.scope=t.Config=t.RouterEventSource=t.RouterEventType=t.RouterEvent=void 0;const n=r(8725);var s=r(23);Object.defineProperty(t,"RouterEvent",{enumerable:!0,get:function(){return s.RouterEvent}}),Object.defineProperty(t,"RouterEventType",{enumerable:!0,get:function(){return s.RouterEventType}}),Object.defineProperty(t,"RouterEventSource",{enumerable:!0,get:function(){return s.RouterEventSource}});var i=r(8452);Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return i.Config}}),Object.defineProperty(t,"scope",{enumerable:!0,get:function(){return i.scope}}),t.route=function(e,t,r,s){return(0,n.route)(new n.RouterEntity(e,t,new n.RouterEntityState(r.process,r.scripts)),s)}},8870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.savePosition=t.loadTitle=void 0;var n=r(4226);Object.defineProperty(t,"loadTitle",{enumerable:!0,get:function(){return n.loadTitle}}),Object.defineProperty(t,"savePosition",{enumerable:!0,get:function(){return n.savePosition}})},396:(e,t)=>{"use strict";function r(){window.history.replaceState({...window.history.state,title:document.title},document.title)}function n(){window.history.replaceState({...window.history.state,position:{...window.history.state?.position,top:window.scrollY,left:window.scrollX}},document.title)}Object.defineProperty(t,"__esModule",{value:!0}),t.savePjax=t.isTransitable=t.savePosition=t.loadPosition=t.saveTitle=t.loadTitle=void 0,r(),n(),t.loadTitle=function(){return window.history.state?.title||document.title},t.saveTitle=r,t.loadPosition=function(){return window.history.state?.position||{top:window.scrollY,left:window.scrollX}},t.savePosition=n,t.isTransitable=function(e){return!0===e?.pjax?.transition},t.savePjax=function(){window.history.replaceState({...window.history.state,pjax:{...window.history.state?.pjax,transition:!0}},document.title)}},8452:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Config=t.scope=void 0;const n=r(9888);var s=r(1531);Object.defineProperty(t,"scope",{enumerable:!0,get:function(){return s.scope}});t.Config=class{constructor(e){this.areas=["body"],this.link=":is(a, area)[href]:not([target])",this.form="form:not([method])",this.replace="",this.memory=void 0,this.fetch={rewrite:void 0,headers:new Headers,timeout:3e3,wait:0},this.update={rewrite:void 0,head:"base, meta, link",css:!0,script:!0,ignore:"",ignores:{$:void 0,extension:'[href^="chrome-extension://"]',security:'[src*=".scr.kaspersky-labs.com/"]'},reload:"",log:""},this.sequence=new i,this.scope={},this.isolation=!1,(0,n.extend)(this,e),this.update.ignores.$??=e.update?.ignore??"",this.update.ignore=Object.values(this.update.ignores).filter((e=>e)).join(","),(0,n.overwrite)(this.scope,e?.scope??{}),Object.freeze(this),Object.freeze(this.fetch),Object.freeze(this.update)}filter(e){return!0}fallback(e,t){if(e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement)window.location.assign(e.href);else if(e instanceof HTMLFormElement)window.location.assign(e.action);else{if(!(e instanceof Window))throw t;window.location.reload()}}};class i{async fetch(){return"seq:fetch"}async unload(){return"seq:unload"}async content(){return"seq:content"}async ready(){return"seq:ready"}async load(){}}},1531:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scope=void 0;const n=r(8452),s=r(7727),i=r(6189),o=r(9888),{match:c}=s.router.helpers();t.scope=function e(t,r){const s={"/":{},...t.scope};for(const a of Object.keys(s).reverse()){const u=s[a];switch(+c(a,r.orig)+ +c(a,r.dest)){case 0:continue;case 1:if(void 0===u||u.isolation)return i.Nothing;continue}return u?u.scope?e((0,o.overwrite)({},{...t,scope:void 0},u),r):(0,i.Just)(new n.Config({...(0,o.extend)({},t,u),scope:void 0})):i.Nothing}return i.Nothing}},23:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouterEventLocation=t.RouterEventRequest=t.RouterEventMethod=t.RouterEventType=t.RouterEventSource=t.RouterEvent=void 0;const n=r(3072),s=r(1904),i=r(8400);var o,c,a;t.RouterEvent=class{constructor(e,t){this.original=e,this.base=t,this.type=this.original.type.toLowerCase(),this.source=this.original[i.currentTarget],this.request=new u(this.source,this.base),this.location=new l(this.base,this.request.url),Object.freeze(this)}},function(e){e.Anchor=HTMLAnchorElement,e.Area=HTMLAreaElement,e.Form=HTMLFormElement,e.Window=window.Window}(o||(t.RouterEventSource=o={})),function(e){e.Click="click",e.Submit="submit",e.Popstate="popstate"}(c||(t.RouterEventType=c={})),function(e){e.GET="GET",e.POST="POST"}(a||(t.RouterEventMethod=a={}));class u{constructor(e,t){this.source=e,this.base=t,this.method=(()=>{if(this.source instanceof o.Anchor||this.source instanceof o.Area)return a.GET;if(this.source instanceof o.Form)return this.source.method.toUpperCase()===a.POST?a.POST:a.GET;if(this.source instanceof o.Window)return a.GET;throw new Error("Invalid event source")})(),this.url=(()=>{if(this.source instanceof o.Anchor||this.source instanceof o.Area)return new s.URL((0,s.standardize)(this.source.href,this.base.href));if(this.source instanceof o.Form)return this.source.method.toUpperCase()===a.GET?new s.URL((0,s.standardize)(this.source.action.split(/[?#]/)[0]+`?${(0,n.serialize)(this.source)}`,this.base.href)):new s.URL((0,s.standardize)(this.source.action.split(/[?#]/)[0],this.base.href));if(this.source instanceof o.Window)return new s.URL((0,s.standardize)(window.location.href));throw new Error("Invalid event source")})(),this.body=(()=>this.source instanceof o.Form&&this.method===a.POST?new FormData(this.source):null)(),Object.freeze(this)}}t.RouterEventRequest=u;class l{constructor(e,t){this.orig=e,this.dest=t,Object.freeze(this)}}t.RouterEventLocation=l},8725:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.route=t.RouterEntityState=t.RouterEntity=void 0;const n=r(8950),s=r(1073),i=r(7747),o=r(4226),c=r(7704);var a=r(7293);Object.defineProperty(t,"RouterEntity",{enumerable:!0,get:function(){return a.RouterEntity}}),Object.defineProperty(t,"RouterEntityState",{enumerable:!0,get:function(){return a.RouterEntityState}}),t.route=async function(e,t){return(0,c.Right)(void 0).bind(e.state.process.either).bind((()=>function(e,t){return(0,i.separate)({src:e,dst:e},t).extract((()=>!1),(()=>!0))}(t.document,e.config.areas)?(0,c.Right)(void 0):(0,c.Left)(new Error("Failed to match the areas")))).fmap((()=>(0,n.fetch)(e))).fmap((async r=>(await r).fmap((([r,n])=>(0,s.update)(e,r,n,{document:t.document,position:o.loadPosition}))).extract(c.Left))).extract(c.Left)}},7293:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouterEntityState=t.RouterEntity=void 0;t.RouterEntity=class{constructor(e,t,r){this.config=e,this.event=t,this.state=r,Object.freeze(this)}};t.RouterEntityState=class{constructor(e,t){this.process=e,this.scripts=t,Object.freeze(this)}}},5474:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Response=void 0;const n=r(6135),s=r(1904);t.Response=class{constructor(e,t){if(this.url=e,this.xhr=t,this.header=e=>this.xhr.getResponseHeader(e),this.document=this.xhr.responseXML.cloneNode(!0),e.origin!==new s.URL(t.responseURL,window.location.href).origin)throw new Error("Redirected to another origin");Object.defineProperty(this.document,"URL",{configurable:!0,enumerable:!0,value:e.href,writable:!1}),(0,n.fix)(this.document),Object.freeze(this)}}},8950:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=void 0;const n=r(23),s=r(4991),i=r(9152);t.fetch=async function({event:e,config:t,state:r}){const o=new Headers(t.fetch.headers);o.has("Accept")||o.set("Accept","text/html"),o.has("X-Pjax")||o.set("X-Pjax",JSON.stringify(t.areas));const c=e.type===n.RouterEventType.Popstate?t.memory?.get(e.location.dest.path):void 0,[a,u]=await Promise.all([t.sequence.fetch(void 0,{path:e.request.url.path,method:e.request.method,headers:o,body:e.request.body}),(0,s.xhr)(e.request.method,e.request.url,e.location.orig,o,e.request.body,t.fetch.timeout,r.process,t.fetch.rewrite,c),(0,i.wait)(t.fetch.wait),window.dispatchEvent(new Event("pjax:fetch"))]);return u.bind(r.process.either).fmap((e=>[e,a]))}},4991:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.match_=t.xhr=void 0;const n=r(5474),s=r(8312),i=r(7704),o=r(1904),c=r(1825);function a(e,t){const r=s(e||"").sort(),n=s(t).sort();for(let e=0,t=0;e<r.length&&t<n.length;)switch(r[e].localeCompare(n[t])){case 0:return!0;case-1:++e;continue;case 1:++t;continue;default:throw new Error("Unreachable")}return!1;function s(e){return e.split(/\s*;\s*/).filter((e=>e.length>0))}}t.xhr=function(e,t,r,u,l,h,d,p=c.noop,f){return new s.AtomicPromise((s=>{const c=p(t.href,e,u,h,l,f)??function(e,t,r,n,s){const i=new XMLHttpRequest;i.open(t,e,!0);for(const[e,t]of r)i.setRequestHeader(e,t);return i.responseType="document",i.timeout=n,i.send(s),i}(t.href,e,u,h,l);if("document"!==c.responseType)throw new Error("Response type must be 'document'");d.register((()=>{c.abort()})),h&&setTimeout((()=>c.readyState<3&&c.abort()),h+100),c.addEventListener("abort",(()=>{s((0,i.Left)(new Error("Failed to request a page by abort")))})),c.addEventListener("error",(()=>{s((0,i.Left)(new Error("Failed to request a page by error")))})),c.addEventListener("timeout",(()=>{s((0,i.Left)(new Error("Failed to request a page by timeout")))})),c.addEventListener("load",(()=>{(function(e,t){const r=new o.URL((0,o.standardize)(t.responseURL,e.href));switch(!0){case!t.responseURL:return(0,i.Left)(new Error("Failed to get the response URL"));case r.origin!==new o.URL("",window.location.origin).origin:return(0,i.Left)(new Error("Redirected to another origin"));case!/2..|304/.test(`${t.status}`):return(0,i.Left)(new Error("Failed to validate the status of response"));case!t.response:return(0,i.Left)(new Error("Failed to get the response body"));case!a(t.getResponseHeader("Content-Type"),"text/html"):return(0,i.Left)(new Error("Failed to validate the content type of response"));default:return(0,i.Right)(t)}})(r,c).fmap((e=>{const s=new o.URL((0,o.standardize)((i=e.responseURL,c=t.href,!i.includes("#")&&c.includes("#")?i+c.slice(c.indexOf("#")):i),r.href));var i,c;return new n.Response(s,e)})).extract((e=>{s((0,i.Left)(e))}),(e=>{s((0,i.Right)(e))}))}))}))},t.match_=a},1073:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update=void 0;const n=r(23),s=r(2289),i=r(6255),o=r(4440),c=r(8274),a=r(7747),u=r(8697),l=r(1883),h=r(1938),d=r(8949),p=r(4226),f=r(8312),m=r(7704),v=r(8553);t.update=function({event:e,config:t,state:r},y,g,w){const{process:b}=r,S={src:y.document,dst:w.document};return f.AtomicPromise.resolve(g).then(b.either).then((e=>e.bind((()=>(0,a.separate)(S,t.areas).extract((()=>(0,m.Left)(new Error("Failed to separate the areas"))),(()=>e)))))).then((r=>r.bind((e=>(0,a.separate)(S,t.areas).fmap((([t])=>[e,t])).extract((()=>(0,m.Left)(new Error("Failed to separate the areas"))),b.either))).fmap((([r,s])=>{const i=e.type===n.RouterEventType.Popstate?t.memory?.get(e.location.dest.path):void 0;return t.update.rewrite?.(e.location.dest.href,S.src,s,i),r})).bind((e=>(0,a.separate)(S,t.areas).fmap((([,t])=>[e,t])).extract((()=>(0,m.Left)(new Error("Failed to separate the areas"))),b.either))))).then((e=>e.bind((()=>(0,a.separate)(S,t.areas).extract((()=>(0,m.Left)(new Error("Failed to separate the areas"))),(()=>e)))).fmap((async([e,r])=>{const n=await t.sequence.unload(e,{...y,url:y.url.href});return window.dispatchEvent(new Event("pjax:unload")),[n,r]})))).then((e=>m.Either.sequence(e))).then(b.promise).then((g=>g.fmap((([g,q])=>(0,v.HList)().add(((0,s.blur)(S.dst),(0,p.savePjax)(),(0,i.url)(new n.RouterEventLocation(e.location.orig,y.url),S.src.title,e.type,e.source,t.replace),(0,p.savePjax)(),(0,o.title)(S),(0,p.saveTitle)(),(0,c.head)(S,t.update.head,t.update.ignore),b.either((0,a.content)(S,q)).fmap((([e,t])=>[e,f.AtomicPromise.all(t)])))).unfold((async n=>(await n).fmap((async([n])=>{t.update.css&&(0,u.css)(S,t.update.ignore);const s=await t.sequence.content(g,n);w.document.dispatchEvent(new Event("pjax:content"));const[i]=t.update.script?await(0,l.script)(S,r.scripts,t.update,10*t.fetch.timeout,b):[f.AtomicPromise.resolve(b.either([[],f.AtomicPromise.resolve(b.either([]))]))];return(0,h.focus)(e.type,S.dst),(0,d.scroll)(e.type,S.dst,{hash:e.location.dest.fragment,position:w.position}),(0,p.savePosition)(),i.then((async e=>[e.fmap((([e,t])=>[e,t.then((e=>e.extract()))])),await t.sequence.ready(s),w.document.dispatchEvent(new Event("pjax:ready"))]))})).fmap((e=>e.then((([e,t])=>e.fmap((e=>[e,t])))))).extract((e=>f.AtomicPromise.resolve((0,m.Left)(e)))))).reverse())))).then(b.promise).then((e=>e.fmap((([e,r])=>(f.AtomicPromise.all([e,r]).then((([e,r])=>e.bind((([,e])=>r.fmap((([[,r],n])=>f.AtomicPromise.all([e,r]).then(b.either).then((e=>e.fmap((async([e])=>(await t.sequence.load(n,e),void window.dispatchEvent(new Event("pjax:load"))))).extract((()=>{})))))))).extract((()=>{})))),r))))).then((e=>m.Either.sequence(e).then((e=>e.join())))).then((e=>e.fmap((([e])=>e))))}},2289:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blur=void 0,t.blur=function(e){e===window.document&&e.activeElement!==e.body&&(e.activeElement.blur(),e.body.focus())}},7747:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._wait=t._split=t.separate=t.content=void 0;const n=r(1883),s=r(8312),i=r(6189),o=r(6876),c=r(2282),a=r(8400);function u(e){const t=[],r=[],n={"]":"[",")":"("};let s="";for(const t of e.match(/\\.?|[,"()\[\]]|[^\\,"()\[\]]+|$/g)){switch(t){case"":i();continue;case",":0===r.length?i():s+=t;continue;case'"':'"'===r[0]?r.shift():r.unshift(t);break;case"[":case"(":'"'!==r[0]&&r.unshift(t);break;case"]":case")":r[0]===n[t]&&r.shift()}s+=t}return t;function i(){t.push(s.trim()),s=""}}function l(e){return s.AtomicPromise.race([new s.AtomicPromise((t=>{(0,a.once)(e,"load",t)})),new s.AtomicPromise((t=>{(0,a.once)(e,"abort",t)})),new s.AtomicPromise((t=>{(0,a.once)(e,"error",t)}))])}t.content=function(e,t,r={replace:(e,t)=>{t.parentNode.replaceChild(e,t)}}){return[t.map((e=>e.dst)).reduce(o.push,[]),t.map((function(t){return t.src.map(((r,n)=>({src:e.dst.importNode(t.src[n].cloneNode(!0),!0),dst:t.dst[n]}))).map((e=>(function(e){const t=[...e.src.querySelectorAll("script")].map(n.escape).reduce(((e,t)=>()=>{e(),t()}),(()=>{}));r.replace(e.src,e.dst),t()}(e),(0,c.querySelectorAll)(e.src,"img, iframe, frame").map(l)))).reduce(o.push,[])})).reduce(o.push,[])]},t.separate=function(e,t){return t.reduce(((t,r)=>i.Maybe.mplus(t,function(e,t){return(0,i.Just)(u(t)).bind((t=>t.reduce(((t,r)=>t.bind((t=>{const n=(0,c.querySelectorAll)(e.src,r),s=(0,c.querySelectorAll)(e.dst,r);return n.length>0&&n.length===s.length?(0,i.Just)((0,o.push)(t,[{src:n,dst:s}])):i.Nothing}))),(0,i.Just)([]))))}(e,r).fmap((e=>[r,e])))),i.Nothing)},t._split=u,t._wait=l},8697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=void 0;const n=r(4907);t.css=function(e,t){return void["head","body"].map((t=>[e.src.querySelector(t),e.dst.querySelector(t)])).forEach((([e,t])=>{(0,n.sync)((0,n.pair)(r(e),r(t),((e,t)=>e.outerHTML===t.outerHTML)),t)}));function r(e){return[...e.querySelectorAll('link[rel~="stylesheet"], style')].filter((e=>!t||!e.matches(t)))}}},1938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;const n=r(23);t.focus=function(e,t){switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return void[...t.querySelectorAll("[autofocus]")].slice(-1).filter((e=>e.closest("html")===window.document.documentElement&&e!==t.activeElement)).forEach((e=>{e.focus()}));case n.RouterEventType.Popstate:return;default:throw new TypeError(e)}}},8274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.head=void 0;const n=r(4907);t.head=function(e,t,r){return r+=t.includes("link")?', link[rel~="stylesheet"]':"",void(0,n.sync)((0,n.pair)(s(e.src.head),s(e.dst.head),((e,t)=>e.outerHTML===t.outerHTML)),e.dst.head);function s(e){return[...e.querySelectorAll(t)].filter((e=>!r||!e.matches(r)))}}},1883:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.escape=t._evaluate=t._fetch=t.script=void 0;const o=r(5986),c=r(8312),a=r(7704),u=r(1904),l=r(6876),h=r(2871),d=r(9152),p=r(394);async function f(e,t){return e.hasAttribute("src")?"module"===e.type.toLowerCase()?(0,a.Right)([e,""]):c.AtomicPromise.race([window.fetch(e.src,{headers:{Accept:"application/javascript"},integrity:e.integrity}),(0,d.wait)(t).then((()=>c.AtomicPromise.reject(new Error(`${e.src}: Timeout`))))]).then((async t=>t.ok?(0,a.Right)([e,await t.text()]):e.matches("[src][async]")?y(e).then((()=>(0,a.Right)([e,""])),(()=>(0,a.Left)(new Error(`${e.src}: ${t.statusText}`)))):(0,a.Left)(new Error(t.statusText))),(e=>(0,a.Left)(e))):(0,a.Right)([e,e.text])}function m(e,t,n,s,l,h){const d=!!(e=e.ownerDocument===document?e:document.importNode(e.cloneNode(!0),!0)).parentElement&&e.parentElement.matches(n.trim()||"_"),p=document.querySelector(d?e.parentElement.id?`#${e.parentElement.id}`:e.parentElement.tagName:"_")||document.body,f=v(e);p.appendChild(e),f(),!d&&e.remove();const m=c.AtomicPromise.resolve(l).then((function(){if(!h.isAlive())throw new o.FatalError("Expired");if(e.matches('[type="module"][src]'))return c.AtomicPromise.resolve(Promise.resolve(`${e.src}`).then((e=>i(r(3911)(e))))).catch((t=>t.message.startsWith("Failed to load ")&&e.matches("[src][async]")?y(e).catch((()=>c.AtomicPromise.reject(t))):c.AtomicPromise.reject(t))).then((()=>(e.dispatchEvent(new Event("load")),(0,a.Right)(e))),(t=>(e.dispatchEvent(new Event("error")),(0,a.Left)(new o.FatalError(t instanceof Error?t.message:t+"")))));try{if(s.has(new u.URL((0,u.standardize)(window.location.href)).href))throw new o.FatalError("Expired");return(0,eval)(t),e.hasAttribute("src")&&e.dispatchEvent(new Event("load")),c.AtomicPromise.resolve((0,a.Right)(e))}catch(t){return e.hasAttribute("src")&&e.dispatchEvent(new Event("error")),c.AtomicPromise.resolve((0,a.Left)(new o.FatalError(t instanceof Error?t.message:t+"")))}}));return e.matches("[src][async]")?(0,a.Right)(m):(0,a.Left)(m)}function v(e){const t=e.getAttribute("src"),r=e.text;return e.removeAttribute("src"),e.text="",()=>{e.text=" ",e.text=r,null!==t&&e.setAttribute("src",t)}}function y(e){return new u.URL((0,u.standardize)(e.src)).origin===new u.URL((0,u.standardize)(window.location.href)).origin?c.AtomicPromise.reject(new Error):(e=(0,p.html)("script",Object.values(e.attributes).reduce(((e,{name:t,value:r})=>(e[t]=r,e)),{}),[...e.childNodes]),new c.AtomicPromise(((t,r)=>{e.addEventListener("load",(()=>{t(void 0)})),e.addEventListener("error",r),document.body.appendChild(e),e.remove()})))}t.script=function(e,t,r,n,s,i={fetch:f,evaluate:m}){const o=[...e.src.querySelectorAll("script")].filter((e=>!e.type||/(?:application|text)\/(?:java|ecma)script|module/i.test(e.type))).filter((e=>!e.matches(r.ignore.trim()||"_"))).filter((e=>!e.hasAttribute("src")||(!t.has(new u.URL((0,u.standardize)(e.src)).href)||e.matches(r.reload.trim()||"_")))),{ss:d,as:p}=o.reduce(((e,t)=>t.matches("[src][async], [src][defer]")?void e.as.push(t)||e:void e.ss.push(t)||e),{ss:[],as:[]}),v=c.AtomicPromise.all(g(d)).then(w),y=c.AtomicPromise.all(g(p)).then(w);return v.then((()=>[c.AtomicPromise.all([v,y]).then((async([e,t])=>e.fmap((async e=>(await e).fmap((([e,r])=>[e,r.then((async e=>t.fmap((async t=>(await t).fmap((([t,r])=>c.AtomicPromise.all([e,e.fmap((()=>t)),r]).then((e=>a.Either.sequence(e).fmap((e=>e.reduce(l.push))))))).extract(a.Left))).extract(a.Left)))])))).extract(a.Left)))]));function g(e){return e.map((e=>i.fetch(e,n)))}function w(e){return a.Either.sequence(e).bind((e=>e.reduce(((e,[n,o])=>e.bind(s.either).bind((([e,u])=>i.evaluate(n,o,r.log,t,c.AtomicPromise.all(e),s).extract((t=>(0,a.Right)((0,h.tuple)((0,l.push)(e,[t]),u))),(t=>(0,a.Right)((0,h.tuple)(e,(0,l.push)(u,[t])))))))),(0,a.Right)([[],[]])))).fmap((([e,t])=>c.AtomicPromise.all(e).then((e=>a.Either.sequence(e))).then((e=>e.fmap((e=>(0,h.tuple)(e,Promise.all(t).then((e=>a.Either.sequence(e))))))))))}},t._fetch=f,t._evaluate=m,t.escape=v},8949:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._hash=t.scroll=void 0;const n=r(23);function s(e,t,r={scrollToElement:e=>{e.scrollIntoView()}}){const n=t.slice(1);if(0===n.length)return!1;const s=e.getElementById(n)||e.getElementsByName(n)[0];return!!s&&(r.scrollToElement(s),!0)}t.scroll=function(e,t,r,i={scrollToElement:e=>{e.scrollIntoView()},scrollToPosition:({top:e,left:t})=>{window.scrollTo(t,e)},hash:s}){switch(e){case n.RouterEventType.Click:if(i.hash(t,r.hash,i))return;return void i.scrollToPosition({top:0,left:0});case n.RouterEventType.Submit:return void i.scrollToPosition({top:0,left:0});case n.RouterEventType.Popstate:return void i.scrollToPosition(r.position());default:throw new TypeError(e)}},t._hash=s},4907:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pair=t.sync=void 0;const n=r(7704),s=r(6876);function i(e,t,r){t.map((t=>e.ownerDocument.importNode(t.cloneNode(!0),!0))).forEach((t=>{e.insertBefore(t,r)}))}function o(e){e.remove()}t.sync=function(e,t,r={before:i,remove:o}){return void e.forEach((([e,n])=>{r.before(function(e){return e?e.parentElement:t}(n),e.slice(-1).some((e=>!!n&&e.outerHTML===n.outerHTML))?e.slice(0,-1):e,n),n&&0===e.length&&r.remove(n)}))},t.pair=function(e,t,r){const i=function(e,t,r){return e.reduce(((e,i)=>0===t.length?e.set(null,(0,s.push)(e.get(null)||[],[i])):t.reduce(((e,t)=>e.bind((e=>!e.has(t)&&r(i,t)?(e.set(t,(0,s.push)(e.get(null)||[],[i])),e.delete(null),(0,n.Left)(e)):(0,n.Right)(e)))),(0,n.Right)(e)).fmap((e=>e.set(null,(0,s.push)(e.get(null)||[],[i])))).extract((e=>e))),new Map)}(e,t,r);return t.filter((e=>!i.has(e))).forEach((e=>{i.set(e,[])})),[...i].map((([e,t])=>[t,e]))}},4440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.title=void 0,t.title=function(e){e.dst.title=e.src.title}},6255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._isReplaceable=t._isRegisterable=t.url=void 0;const n=r(23);function s(e,t){switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return t.dest.href!==t.orig.href;case n.RouterEventType.Popstate:return!1;default:throw new TypeError(e)}}function i(e,t,r){switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return t.matches(r.trim()||"_");case n.RouterEventType.Popstate:return!1;default:throw new TypeError(e)}}(0,r(8400).bind)(document,"pjax:ready",(()=>{window.history.replaceState(window.history.state,window.document.title)})),t.url=function(e,t,r,n,o){switch(!0){case i(r,n,o):return void window.history.replaceState({},t,e.dest.href);case s(r,e):return void window.history.pushState({},t,e.dest.href);default:return}},t._isRegisterable=s,t._isReplaceable=i},4226:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(396),t)},6345:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClickView=void 0;const n=r(8779),s=r(8400);class i extends n.Coroutine{constructor(e,t,r){super((async function*(){return this.finally((0,s.delegate)(e,t,"click",(e=>{(e.currentTarget instanceof HTMLAnchorElement||e.currentTarget instanceof HTMLAreaElement)&&e.currentTarget.matches(t)&&r(e)})))}),{delay:!1})}}t.ClickView=i},3515:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationView=void 0;const n=r(8533),s=r(396),i=r(8779),o=r(1904),c=r(8400);class a extends i.Coroutine{constructor(e,t){super((async function*(){return this.finally((0,c.bind)(e,"popstate",(r=>{(0,s.isTransitable)(n.page.state)&&(0,s.isTransitable)(e.history.state)&&(0,o.standardize)(e.location.href)!==n.page.url.href&&t(r)})))}),{delay:!1})}}t.NavigationView=a},2920:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollView=void 0;const n=r(8533),s=r(8779),i=r(1904),o=r(525),c=r(8400);class a extends s.Coroutine{constructor(e,t){super((async function*(){return this.finally((0,c.bind)(e,"scroll",(0,o.debounce)(100,(r=>{(0,i.standardize)(e.location.href)===n.page.url.href&&t(r)})),{passive:!0}))}),{delay:!1})}}t.ScrollView=a},5801:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubmitView=void 0;const n=r(8779),s=r(8400);class i extends n.Coroutine{constructor(e,t,r){super((async function*(){return this.finally((0,s.delegate)(e,t,"submit",(e=>{e.currentTarget instanceof HTMLFormElement&&r(e)})))}),{delay:!1})}}t.SubmitView=i},2442:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.API=void 0;const n=r(9465),s=r(8413),i=r(8533),o=r(396),c=r(8400);function a(e,t){const r=document.createElement("a");let n;return r.href=e,document.createDocumentFragment().appendChild(r),(0,c.once)(r,"click",(e=>{n=t(e),e.preventDefault()})),r.click(),n}t.API=class{static assign(e,t,r={document:window.document,router:n.route}){return a(e,(e=>r.router(new n.Config(t),new n.RouterEvent(e,i.page.url),s.process,r)))}static replace(e,t,r={document:window.document,router:n.route}){return a(e,(e=>r.router(new n.Config({...t,replace:"*"}),new n.RouterEvent(e,i.page.url),s.process,r)))}static sync(e){e&&(0,o.savePjax)(),s.process.cast("",new Error("Canceled")),i.page.sync()}static pushURL(e,t,r=null){window.history.pushState(r,t,e),this.sync()}static replaceURL(e,t,r=window.history.state){const n=(0,o.isTransitable)(window.history.state);window.history.replaceState(r,t,e),this.sync(n)}}},9869:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GUI=void 0;const n=r(2442),s=r(6345),i=r(5801),o=r(3515),c=r(2920),a=r(9465),u=r(8533);r(7202);const l=r(8413),h=r(8870),d=r(7339),p=r(7218);class f extends n.API{constructor(e,t={document:window.document,router:a.route}){super(),this.options=e,this.io=t,this.view=new m(this.options,this.io),f.resources.clear(),f.resources.register("view",this.view)}assign(e){return n.API.assign(e,this.options,this.io)}replace(e){return n.API.replace(e,this.options,this.io)}}t.GUI=f,f.resources=new class extends d.Supervisor{};class m extends p.Copropagator{constructor(e,t){const r=new a.Config(e),n=e=>{t.router(r,new a.RouterEvent(e,u.page.url),l.process,t)};super([new s.ClickView(t.document,r.link,n),new i.SubmitView(t.document,r.form,n),new o.NavigationView(window,n),new c.ScrollView(window,h.savePosition)])}}},9465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._validate=t.route=t.RouterEventSource=t.RouterEvent=t.Config=void 0;const n=r(7430);Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return n.Config}}),Object.defineProperty(t,"RouterEvent",{enumerable:!0,get:function(){return n.RouterEvent}}),Object.defineProperty(t,"RouterEventSource",{enumerable:!0,get:function(){return n.RouterEventSource}});const s=r(8533),i=r(5131),o=r(5986),c=r(8870),a=r(1904),u=r(3669),l=r(6189),h=r(8312);function d(e,t,r){if(r.original.defaultPrevented)return!1;if(i=e,s.page.url.origin!==i.origin)return!1;var i;switch(r.type){case n.RouterEventType.Click:return!function(e){return s.page.url.resource===e.resource&&""!==e.fragment}(e)&&!p(e)&&!r.source.hasAttribute("download")&&!function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey}(r.original)&&t.filter(r.source);case n.RouterEventType.Submit:return!0;case n.RouterEventType.Popstate:return!p(e)}}function p(e){const t=s.page.url;return t.resource===e.resource&&t.fragment!==e.fragment}t.route=function(e,t,r,p){switch(t.type){case n.RouterEventType.Click:case n.RouterEventType.Submit:(0,c.savePosition)();break;case n.RouterEventType.Popstate:p.document.title=(0,c.loadTitle)()}return(0,l.Just)(0).guard(d(t.request.url,e,t)).bind((()=>(0,n.scope)(e,{orig:t.location.orig.pathname,dest:t.location.dest.pathname}))).fmap((async e=>{t.original.preventDefault(),r.cast("",new Error("Canceled"));const c=new u.Cancellation,l=r.register("",(e=>(l(),c.cancel(e),h.never)));s.page.isAvailable()&&e.memory?.set(t.location.orig.path,p.document.cloneNode(!0)),s.page.process(t.location.dest);const[d]=await i.env;return(0,n.route)(e,t,{process:c,scripts:d},p).then((e=>e.fmap((async([e,t])=>{l(),s.page.complete();for(const t of e.filter((e=>e.hasAttribute("src"))))d.add(new a.URL((0,a.standardize)(t.src)).href);for(const e of(await t).filter((e=>e.hasAttribute("src"))))d.add(new a.URL((0,a.standardize)(e.src)).href)})).extract())).catch((r=>{l(),s.page.complete(),(c.isAlive()||r instanceof o.FatalError)&&e.fallback(t.source,r)}))})).extract((()=>{switch(t.type){case n.RouterEventType.Click:case n.RouterEventType.Submit:return r.cast("",new Error("Canceled")),s.page.sync(),!1;case n.RouterEventType.Popstate:return d(t.location.dest,e,t)?(e.fallback(t.source,new Error("Disabled")),s.page.sync(),!0):(r.cast("",new Error("Canceled")),s.page.sync(),!1);default:throw new TypeError(t.type)}}),(()=>!0))},t._validate=d},5131:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const n=r(8521);t.env=Promise.all([n.scripts,new Promise((e=>{setTimeout(e)}))])},8533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.page=void 0;const n=r(396),s=r(1904),i=r(8400);(0,i.bind)(window,"hashchange",(()=>{t.page.sync()}),!0),(0,i.bind)(window,"popstate",(()=>(0,n.isTransitable)(t.page.state)&&(0,n.isTransitable)(window.history.state)||void t.page.sync()),!0),t.page=new class{constructor(){this.$url=new s.URL((0,s.standardize)(window.location.href)),this.$state=window.history.state,this.available=!0}get url(){return this.$url}get state(){return this.$state}isAvailable(){return this.available}process(e){this.available=!1,this.target=e}complete(){this.$url=this.target??new s.URL((0,s.standardize)(window.location.href)),this.target=void 0,this.$state=window.history.state,this.available=!0}sync(){this.$url=new s.URL((0,s.standardize)(window.location.href)),this.target=void 0,this.$state=window.history.state}}},8413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.process=void 0;const n=r(7339);t.process=new class extends n.Supervisor{}},8521:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scripts=void 0;const n=r(8533),s=r(1904),i=r(8400);t.scripts=new Set,(0,i.bind)(window,"pjax:unload",(()=>{document.querySelectorAll("script[src]").forEach((e=>{t.scripts.add(new s.URL((0,s.standardize)(e.src,n.page.url.href)).href)}))}))},7202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(396),s=r(8400);(0,n.isTransitable)(window.history.state)&&(window.history.scrollRestoration="manual"),(0,s.bind)(window,"pjax:fetch",(()=>window.history.scrollRestoration="manual"),!0),(0,s.bind)(document,"pjax:ready",(()=>window.history.scrollRestoration="manual"),!0),(0,s.bind)(window,"unload",(()=>window.history.scrollRestoration="auto"),!0)},3072:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=void 0,t.serialize=function(e){return[...e.elements].filter((e=>{if(!("name"in e))return!1;if(e.disabled)return!1;switch(e.tagName){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":case"radio":return e.checked;case"submit":case"button":case"image":case"reset":case"file":return!1;default:return!0}case"SELECT":case"TEXTAREA":return!0;default:return!1}})).map((e=>[encodeURIComponent(t(e.name)),encodeURIComponent(t(e.value))].join("="))).join("&");function t(e){return e.replace(/[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?<![\uD800-\uDBFF])[\uDC00-\uDFFF]/g,"")}}},5986:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FatalError=void 0;class r extends Error{constructor(e){super(e)}}t.FatalError=r,r.prototype.name="FatalError"},6135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fix=t.parse=void 0;const n=r(6189),s=r(7704);function i(e){!function(e){for(const t of e.querySelectorAll("noscript"))t.firstElementChild&&(t.textContent=t.innerHTML)}(e)}t.parse=[function(e){const t=(new DOMParser).parseFromString(e,"text/html");return i(t),t},function(e){const t=window.document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),i(t),t}].reduce(((e,t)=>e.bind((()=>function(e){try{const t=e('\n<html lang="en" class="html">\n  <head>\n    <link href="/">\n    <title>&amp;</title>\n    <noscript><style><></style></noscript>\n  </head>\n  <body>\n    <noscript><style><></style></noscript>\n    <a href="/"></a>\n    <script>document.head.remove();<\/script>\n    <img src="abc">\n  </body>\n</html>\n');switch(!1){case"&"===t.title:case!!t.querySelector('html.html[lang="en"]'):case!!t.querySelector("head > link").href:case!!t.querySelector("body > a").href:case!t.querySelector("noscript > *"):case"document.head.remove();"===t.querySelector("script").innerHTML:case t.querySelector("img").src.endsWith("abc"):case"<style><></style>"===t.querySelector("head > noscript").textContent:case"<style><></style>"===t.querySelector("body > noscript").textContent:throw void 0}return!0}catch{return!1}}(t)?(0,s.Left)(t):e))),(0,s.Right)((()=>n.Nothing))).extract((e=>t=>(0,n.Just)(e(t)))),t.fix=i},3026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeXMLHttpRequest=void 0;const n=r(8312),s=r(9522);class i extends XMLHttpRequest{static create(e,t){const r=new i;return n.AtomicPromise.resolve(t).then((t=>{4!==r.readyState&&(Object.defineProperties(r,{responseURL:{value:e},responseXML:{value:t}}),r.send())}),(t=>{if(4===r.readyState)return;const n=t instanceof Response?t:new Response(null,r);Object.defineProperties(r,{responseURL:{value:e},readyState:{value:4},status:{value:n.status||400},statusText:{value:n.statusText||"Bad Request"}}),r.dispatchEvent(new ProgressEvent("error"))})),r}constructor(){super(),this.responseType="document"}send(e){4!==this.readyState&&(Object.defineProperties(this,{readyState:{configurable:!0,value:3}}),this.dispatchEvent(new ProgressEvent("loadstart")),s.clock.now((()=>{4!==this.readyState&&(Object.defineProperties(this,{response:{get:()=>"document"===this.responseType?this.responseXML:this.responseText},readyState:{value:4},status:{value:200},statusText:{value:"OK"}}),this.dispatchEvent(new ProgressEvent("loadend")),this.dispatchEvent(new ProgressEvent("load")))})))}abort(){4!==this.readyState&&(Object.defineProperties(this,{readyState:{value:4},status:{value:400},statusText:{value:"Bad Request"}}),this.dispatchEvent(new ProgressEvent("abort")))}getResponseHeader(e){return"content-type"===e.toLowerCase()?"text/html":null}}t.FakeXMLHttpRequest=i},394:function(e){
  /*! typed-dom v0.0.349 https://github.com/falsandtru/typed-dom | (c) 2016, falsandtru | (Apache-2.0 AND MPL-2.0) License */
  var t;t=()=>(()=>{"use strict";var e={5413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSetPrototypeOf=t.ObjectGetPrototypeOf=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.isArray=t.sqrt=t.log10=t.log2=t.log=t.tan=t.cos=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.PI=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.EPSILON=t.MIN_VALUE=t.MIN_SAFE_INTEGER=t.MAX_VALUE=t.MAX_SAFE_INTEGER=void 0,t.MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER,t.MAX_VALUE=Number.MAX_VALUE,t.MIN_SAFE_INTEGER=Number.MIN_SAFE_INTEGER,t.MIN_VALUE=Number.MIN_VALUE,t.EPSILON=Number.EPSILON,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.PI=Math.PI,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.cos=Math.cos,t.tan=Math.tan,t.log=Math.log,t.log2=Math.log2,t.log10=Math.log10,t.sqrt=Math.sqrt,t.isArray=Array.isArray,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectSetPrototypeOf=Object.setPrototypeOf},1934:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.equal=void 0,t.equal=function(e,t){return e==e?e===t:t!=t}},6925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=t.memoize=void 0;const n=r(5413),s=r(1934);t.memoize=function(e,t,r){switch("object"==typeof t&&(r=t,t=void 0),t??=(...e)=>e[0],!0){case(0,n.isArray)(r):return function(e,t,r){return(...n)=>{const s=t(...n);let i=r[s];return void 0!==i||(i=e(...n),r[s]=i),i}}(e,t,r);case r?.constructor===Object:return function(e,t,r){let n=!1;return(...s)=>{const i=t(...s);let o=r[i];return void 0!==o||n&&i in r||(o=e(...s),n||=void 0===o,r[i]=o),o}}(e,t,r);default:return function(e,t,r){let n=!1;return(...s)=>{const i=t(...s);let o=r.get(i);return void 0!==o||n&&r.has(i)||(o=e(...s),n||=void 0===o,r.add?.(i,o)??r.set(i,o)),o}}(e,t,r??new Map)}},t.reduce=function(e,t=((...e)=>e[0])){let r,n={};return(...i)=>{const o=t(...i);return(0,s.equal)(n,o)||(n=o,r=e(...i)),r}}},5761:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defrag=t.prepend=t.append=t.isChildren=t.define=t.element=t.text=t.math=t.svg=t.html=t.frag=t.shadow=void 0;const n=r(5413),s=r(6925);var i;function o(e,t){return(r,n,s)=>!n||l(n)?u(c(e,t,r,{}),n??s):u(a(c(e,t,r,n),n),s)}function c(e,t,r,n){if(!("createElement"in e))throw new Error("Typed-DOM: Scoped custom elements are not supported on this browser");const s="is"in n?{is:n.is}:void 0;switch(t){case"HTML":return e.createElement(r,s);case"SVG":return e.createElementNS("http://www.w3.org/2000/svg",r,s);case"MathML":return e.createElementNS("http://www.w3.org/1998/Math/MathML",r,s)}}function a(e,t){for(const r of Object.keys(t)){if("is"===r)continue;const s=t[r];switch(typeof s){case"string":if(e.setAttribute(r,s),r.startsWith("on")){const t=r.slice(2).toLowerCase();switch(t){case"mutate":case"connect":case"disconnect":const r=`on${t}`;e[r]??Object.defineProperty(e,r,{configurable:!0,enumerable:!1,writable:!0,value:r in e&&!(0,n.hasOwnProperty)(e,r)?e=>e.returnValue:""})}}continue;case"function":if(r.length<3)throw new Error(`Typed-DOM: Attribute names for event listeners must have an event name but got "${r}"`);const t=r.split(/\s+/);for(const r of t){if(!r.startsWith("on"))throw new Error(`Typed-DOM: Attribute names for event listeners must start with "on" but got "${r}"`);const t=r.slice(2).toLowerCase();switch(e.addEventListener(t,s,{passive:["wheel","mousewheel","touchstart","touchmove","touchend","touchcancel"].includes(t)}),t){case"mutate":case"connect":case"disconnect":const r=`on${t}`;e[r]??Object.defineProperty(e,r,{configurable:!0,enumerable:!1,writable:!0,value:r in e&&!(0,n.hasOwnProperty)(e,r)?e=>e.returnValue:""})}}continue;case"object":e.removeAttribute(r);continue;default:continue}}return e}function u(e,t){if(void 0===t)return e;if("string"==typeof t)e.textContent=t;else if(!(0,n.isArray)(t)&&Symbol.iterator in t||e.firstChild)e.replaceChildren(...t);else for(let r=0;r<t.length;++r){const n=t[r];"object"==typeof n?e.appendChild(n):e.append(n)}return e}function l(e){return void 0!==e?.[Symbol.iterator]}!function(e){e.shadows=new WeakMap,e.shadow=(0,s.memoize)(((e,t)=>e.attachShadow(t)),e.shadows),e.fragment=document.createDocumentFragment()}(i||(i={})),t.shadow=function e(r,n,s,o=t.html){return"string"==typeof r?e(o(r),n,s,o):"function"==typeof n?e(r,void 0,s,n):"function"==typeof s?e(r,n,void 0,s):l(n)?e(r,void 0,n,o):u(n?"open"===n.mode?r.shadowRoot??r.attachShadow(n):i.shadow(r,n):r.shadowRoot??i.shadows.get(r)??r.attachShadow({mode:"open"}),s)},t.frag=function(e){return u(i.fragment.cloneNode(!0),e)},t.html=o(document,"HTML"),t.svg=o(document,"SVG"),t.math=o(document,"MathML"),t.text=function(e){return document.createTextNode(e)},t.element=o,t.define=function(e,t,r){return!t||l(t)?u(e,t??r):u(a(e,t),r)},t.isChildren=l,t.append=function(e,t){if(void 0===t)return e;if("string"==typeof t)e.append(t);else if((0,n.isArray)(t)||!(Symbol.iterator in t))for(let r=0;r<t.length;++r){const n=t[r];"object"==typeof n?e.appendChild(n):e.append(n)}else for(const r of t)"object"==typeof r?e.appendChild(r):e.append(r);return e},t.prepend=function(e,t){if(void 0===t)return e;if("string"==typeof t)e.prepend(t);else if((0,n.isArray)(t)||!(Symbol.iterator in t))for(let r=0;r<t.length;++r){const n=t[r];"object"==typeof n?e.insertBefore(n,null):e.prepend(n)}else for(const r of t)"object"==typeof r?e.insertBefore(r,null):e.prepend(r);return e},t.defrag=function(e){const t=[];let r=!1;for(let n=0,s=e.length;n<s;++n){const s=e[n];"object"==typeof s?(t.push(s),r=!1):""!==s&&(r?t[t.length-1]+=s:t.push(s),r=!0)}return t}}},t={},r=function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(5761);return r})(),e.exports=t()},8400:function(e){
  /*! typed-dom v0.0.349 https://github.com/falsandtru/typed-dom | (c) 2016, falsandtru | (Apache-2.0 AND MPL-2.0) License */
  var t;t=()=>(()=>{"use strict";var e={5413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSetPrototypeOf=t.ObjectGetPrototypeOf=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.isArray=t.sqrt=t.log10=t.log2=t.log=t.tan=t.cos=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.PI=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.EPSILON=t.MIN_VALUE=t.MIN_SAFE_INTEGER=t.MAX_VALUE=t.MAX_SAFE_INTEGER=void 0,t.MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER,t.MAX_VALUE=Number.MAX_VALUE,t.MIN_SAFE_INTEGER=Number.MIN_SAFE_INTEGER,t.MIN_VALUE=Number.MIN_VALUE,t.EPSILON=Number.EPSILON,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.PI=Math.PI,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.cos=Math.cos,t.tan=Math.tan,t.log=Math.log,t.log2=Math.log2,t.log10=Math.log10,t.sqrt=Math.sqrt,t.isArray=Array.isArray,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectSetPrototypeOf=Object.setPrototypeOf},1825:(e,t)=>{function r(){}Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.fix=t.id=t.clear=t.singleton=void 0,t.singleton=function(e){let t;return function(...n){return e===r||(t=e.call(this,...n),e=r),t}},t.clear=function(e){return(...t)=>{e(...t)}},t.id=function(e){return e},t.fix=function(e){return t=>{const r=e(t);return t===r||r!=r?r:e(r)}},t.noop=r},8312:(e,t,r)=>{var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.isPromiseLike=t.Internal=t.AtomicPromise=t.internal=void 0;const i=r(5413),o=r(1825);t.internal=Symbol.for("spica/promise::internal");class c{static get[(n=Symbol.toStringTag,Symbol.species)](){return c}static all(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e],o=Array(s.length);let c=!1,a=0;for(let e=0;!c&&e<s.length;++e){const i=s[e];if(h(i)){if(d(i)){const{status:r}=i[t.internal];switch(r.state){case 2:o[e]=r.value,++a;continue;case 3:return n(r.reason)}}i.then((t=>{o[e]=t,++a,a===s.length&&r(o)}),(e=>{n(e),c=!0}))}else o[e]=i,++a}a===s.length&&r(o)}))}static race(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e];for(let e=0;e<s.length;++e){const i=s[e];if(!h(i))return r(i);if(d(i)){const{status:e}=i[t.internal];switch(e.state){case 2:return r(e.value);case 3:return n(e.reason)}}}let o=!1;for(let e=0;!o&&e<s.length;++e)s[e].then((e=>{r(e),o=!0}),(e=>{n(e),o=!0}))}))}static allSettled(e){return new c((r=>{const n=(0,i.isArray)(e)?e:[...e],s=Array(n.length);let o=0;for(let e=0;e<n.length;++e){const i=n[e];if(h(i)){if(d(i)){const{status:r}=i[t.internal];switch(r.state){case 2:s[e]={status:"fulfilled",value:r.value},++o;continue;case 3:s[e]={status:"rejected",reason:r.reason},++o;continue}}i.then((t=>{s[e]={status:"fulfilled",value:t},++o,o===n.length&&r(s)}),(t=>{s[e]={status:"rejected",reason:t},++o,o===n.length&&r(s)}))}else s[e]={status:"fulfilled",value:i},++o}o===n.length&&r(s)}))}static any(e){return new c(((r,n)=>{const s=(0,i.isArray)(e)?e:[...e],o=Array(s.length);let c=!1,a=0;for(let e=0;!c&&e<s.length;++e){const i=s[e];if(!h(i))return r(i);if(d(i)){const{status:n}=i[t.internal];switch(n.state){case 2:return r(n.value);case 3:o[e]=n.reason,++a;continue}}i.then((e=>{r(e),c=!0}),(t=>{o[e]=t,++a,a===s.length&&n(new AggregateError(o,"All promises were rejected"))}))}a===s.length&&n(new AggregateError(o,"All promises were rejected"))}))}static resolve(e){const r=new c(o.noop);return r[t.internal].resolve(e),r}static reject(e){const r=new c(o.noop);return r[t.internal].reject(e),r}constructor(e){if(this[n]="Promise",this[s]=new a,e!==o.noop)try{e((e=>{this[t.internal].resolve(e)}),(e=>{this[t.internal].reject(e)}))}catch(e){this[t.internal].reject(e)}}then(e,r){const n=new c(o.noop);return this[t.internal].then(n[t.internal],e,r),n}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.AtomicPromise=c,s=t.internal;class a{constructor(){this.status={state:0},this.fulfillReactions=[],this.rejectReactions=[]}isPending(){return 0===this.status.state}resolve(e){if(this.isPending()){if(!h(e))return this.status={state:2,value:e},this.resume();if(d(e))return e[t.internal].then(this);this.status={state:1,promise:e},e.then((e=>{this.status={state:2,value:e},this.resume()}),(e=>{this.status={state:3,reason:e},this.resume()}))}}reject(e){if(this.isPending())return this.status={state:3,reason:e},this.resume()}then(e,t,r){const{status:n,fulfillReactions:s,rejectReactions:i}=this;switch(n.state){case 2:if(0!==s.length)break;return l(e,!0,t,n.value);case 3:if(0!==i.length)break;return l(e,!1,r,n.reason)}s.push({internal:e,state:!0,procedure:t}),i.push({internal:e,state:!1,procedure:r})}resume(){const{status:e,fulfillReactions:t,rejectReactions:r}=this;switch(e.state){case 0:case 1:return;case 2:if(0!==r.length&&(this.rejectReactions=[]),0===t.length)return;return u(t,e.value),void(this.fulfillReactions=[]);case 3:if(0!==t.length&&(this.fulfillReactions=[]),0===r.length)return;return u(r,e.reason),void(this.rejectReactions=[])}}}function u(e,t){for(let r=0;r<e.length;++r){const{internal:n,state:s,procedure:i}=e[r];l(n,s,i,t)}}function l(e,t,r,n){if(null==r)return t?e.resolve(n):e.reject(n);try{e.resolve(r(n))}catch(t){e.reject(t)}}function h(e){return null!=e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then}function d(e){return t.internal in e}t.Internal=a,t.isPromiseLike=h,t.never=new class e extends Promise{static get[Symbol.species](){return e}constructor(){super(o.noop)}then(){return this}catch(){return this}finally(){return this}}},1365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bind=t.delegate=t.once=t.listen=t.currentTarget=void 0;const n=r(5413),s=r(8312),i=r(1825);function o(e,t,r,n,i){switch(typeof r){case"string":switch(typeof n){case"function":return c(e,t,r,n,{..."boolean"==typeof i?{capture:i}:i,once:!0});case"object":i={...n,once:!0};break;default:i={once:!0}}return new s.AtomicPromise((n=>{c(e,t,r,n,i)}));case"function":return a(e,t,r,{..."boolean"==typeof n?{capture:n}:n,once:!0});case"object":i={...r,once:!0};break;default:i={once:!0}}return new s.AtomicPromise((r=>{a(e,t,r,i)}))}function c(e,t,r,n,s){return a(e,r,(e=>{const i=e.target.shadowRoot?e.composedPath()[0]?.closest(t):e.target?.closest(t);i&&o(i,r,(t=>{t===e&&n(e)}),s)}),{..."boolean"==typeof s?{capture:!0}:s,capture:!0})}function a(e,r,s,o){switch(r){case"mutate":case"connect":case"disconnect":const t=`on${r}`;e[t]??Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:t in e&&!(0,n.hasOwnProperty)(e,t)?e=>e.returnValue:""})}return e.addEventListener(r,c,o),(0,i.singleton)((()=>{e.removeEventListener(r,c,o)}));function c(e){e[t.currentTarget]=e.currentTarget,s(e)}}t.currentTarget=Symbol.for("typed-dom::currentTarget"),t.listen=function(e,t,r,n,s){return"string"==typeof r?c(e,t,r,n,s):a(e,t,r,n)},t.once=o,t.delegate=c,t.bind=a}},t={},r=function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(1365);return r})(),e.exports=t()},2282:function(e){
  /*! typed-dom v0.0.349 https://github.com/falsandtru/typed-dom | (c) 2016, falsandtru | (Apache-2.0 AND MPL-2.0) License */
  var t;t=()=>(()=>{"use strict";var e={};return(()=>{var t=e;Object.defineProperty(t,"__esModule",{value:!0}),t.querySelectorAll=t.querySelectorAllWith=t.querySelectorWith=void 0,t.querySelectorWith=function(e,t){return"matches"in e&&e.matches(t)?e:e.querySelector(t)},t.querySelectorAllWith=function(e,t){const r=[];"matches"in e&&e.matches(t)&&r.push(e);for(let n=e.querySelectorAll(t),s=n.length,i=0;i<s;++i)r.push(n[i]);return r},t.querySelectorAll=function(e,t){const r=[];for(let n=e.querySelectorAll(t),s=n.length,i=0;i<s;++i)r.push(n[i]);return r}})(),e})(),e.exports=t()},3911:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=3911,e.exports=t}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}return r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(8257)})()));
  //# sourceMappingURL=/sm/736d73635a2cba8339eaa35217ee1c721f9aed8460afe34bfaa8ad1cfdcaf013.map